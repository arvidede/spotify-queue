{"version":3,"sources":["utils/index.ts","utils/helpers.ts","utils/hooks.ts","utils/routes.ts","utils/constants.ts","utils/auth.ts","utils/api.ts","utils/spotify.ts","assets/img/placeholder.png","components/Common/Header.tsx","components/Common/Button.tsx","components/Common/URLNotFound.tsx","components/Common/Spinner.tsx","components/Common/Icons.tsx","components/Start/Start.tsx","components/Start/Host.tsx","components/Start/Join.tsx","components/Start/TextInput.tsx","components/Start/Redirect.tsx","components/Search/SearchInput.tsx","components/Search/SearchResults.tsx","components/Search/Search.tsx","components/Host/Host.tsx","components/Host/TrackList.tsx","components/Host/Image.tsx","components/Host/Overlay.tsx","components/Host/ControllButton.tsx","components/Host/PopUpMenu.tsx","components/Host/ConnectButton.tsx","components/Host/ProgressBar.tsx","components/Host/Controller.tsx","components/Host/Player.tsx","components/Spectator/Spectator.tsx","components/Spectator/TrackList.tsx","components/Login/Login.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["validateRoomID","s","length","includes","tokenHasExpired","token","expires_on","Date","now","Fetch","url","method","body","signal","fetch","credentials","headers","JSON","stringify","undefined","then","gatherResponse","catch","console","error","response","a","async","status","Error","json","setVote","id","vote","votes","getVotes","push","filter","v","localStorage","setItem","VOTED_TRACKS","getItem","parse","setupLocalStorage","millisToMinutesAndSeconds","millis","minutes","Math","floor","seconds","useDebouncedInput","onUpdate","onCancel","useState","input","setInput","debouncedInput","value","delay","debouncedValue","setDebouncedValue","useEffect","handler","setTimeout","clearTimeout","useDebounce","handleInputChange","e","target","useSearch","searchInput","setSearchInput","searching","setSearching","api","useAPI","search","useAsyncAbortable","abortSignal","text","doSearchTrack","handleCancelSearch","useCallback","reset","handleEscapePressed","key","document","addEventListener","removeEventListener","cancelSearch","searchUpdate","useWebSocket","queue","useQueue","history","useHistory","subscribers","setSubscribers","doValidateRoomID","isValid","doGetQueue","setTracks","doLeaveRoom","callbacks","n","addTrackToQueue","addedToQueue","removeTrackFromQueue","removedFromQueue","voted","doJoinRoom","tracks","setVotes","setVoteInStorage","useVotes","sort","b","addToQueue","track","doAddTrackToQueue","queue_id","removeFromQueue","doRemoveTrackFromQueue","t","log","doVoteForTrack","copy","index","findIndex","useInterval","callback","savedCallback","useRef","current","setInterval","clearInterval","START","ROOM","LOGIN","HOST","REDIRECT","BASE_URL","process","SOCKET_URL","HOST_URL","SEARCH_URL","VALIDATE_ROOM_URL","AUTHORIZE_URL","REQUEST_TOKEN_URL","REFRESH_TOKEN_URL","GET_QUEUE_URL","ADD_TRACK_TO_QUEUE_URL","REMOVE_TRACK_FROM_QUEUE_URL","PING_URL","SPOTIFY_PLAYER_RECOMMENDATION_URL","SPOIFY_BASE_URL","SPOTIFY_PLAYER_BASE_URL","SPOTIFY_PLAYER_PLAY_URL","SPOTIFY_PLAYER_PAUSE_URL","SPOTIFY_PLAYER_NEXT_TRACK_URL","SPOTIFY_PLAYER_PREVIOUS_TRACK_URL","SPOTIFY_PLAYER_SEEK_URL","SPOTIFY_PLAYER_GET_DEVICES_URL","SPOTIFY_PLAYER_SET_DEVICE_URL","SPOTIFY_USER_TOKEN","LAST_PLAYED_TRACK","Auth","auth","roomId","doLogin","doSignOut","this","AuthContext","React","createContext","API","ws","host","window","roomID","inSession","connect","WebSocket","onopen","onclose","par","check","onerror","err","close","readyState","CLOSED","ping","doSendMessage","type","payload","message","Message","interval","OPEN","send","cb","onmessage","data","doAuthorizeUser","Promise","resolve","doRefreshUserToken","left","screen","width","top","height","popup","open","location","href","res","replace","alert","doFetchUserToken","code","expires_in","refresh_token","newToken","doSetupRoom","query","room","APIContext","useContext","SpotifyPlayer","playerInterval","pollingCallback","abortController","pollPlayerState","next","getPlayerState","clearPolling","request","getDevices","devices","setDevice","config","device_ids","playTrack","uris","abort","AbortController","playSimilarTrack","changeTrack","togglePlayback","isPlaying","seekInPlayingTrack","ms","refreshToken","Authorization","access_token","useSpotify","initialFetch","setInitialFetch","spotify","useMemo","playerState","setPlayerState","state","item","controller","fetching","module","exports","Header","size","color","numSubscribers","className","onClick","goBack","Button","loading","URLNotFound","Dots","Close","viewBox","d","Next","x","y","Previous","transform","Shuffle","Connect","strokeWidth","strokeLinejoin","rx","cx","cy","r","Speaker","Phone","Computer","Play","Pause","PersonIcon","enableBackground","fill","stroke","strokeLinecap","strokeMiterlimit","Heart","HeartOutline","Start","onSelect","setError","setLoading","ROUTES","Host","isLoading","Join","inputVisible","setInputVisible","joinRef","createElement","handleSubmit","handleClickOutside","contains","handleEnterPressed","ref","onChange","placeholder","visible","TextInput","Redirect","props","URLSearchParams","get","opener","tokenCallback","SearchInput","onSearchUpdate","inputRef","hasFocus","setFocus","handleCancel","blur","handleKeyPressed","tabIndex","onFocus","onBlur","SearchResults","onAddTrack","onRemoveTrack","map","queuedTracks","setQueuedTracks","Array","src","album","album_s","require","alt","title","artist","handleAddTrack","Search","children","css","result","match","params","onDelete","onPlay","TrackList","OPTIONS","perspective","speed","max","Image","tilt","VanillaTilt","init","Overlay","showOverlay","setShowOverlay","ControllButton","isCircled","renderIcon","PopUp","device","is_restricted","is_active","disabled","getIcon","name","ConnectButton","isVisible","setIsVisible","setDevices","mounted","ProgressBar","onSeek","onEnd","progress","setProgress","styles","progressBar","currentTarget","progressBarWidth","offsetWidth","progressBarProgressClicked","clientX","getBoundingClientRect","progressInMs","round","style","DisabledController","Controller","is_playing","setIsPlaying","handlePlayNextTrack","duration_ms","progress_ms","PLACEHOLDER_TRACK","Player","playerIsActive","images","artists","Spectator","memo","onVote","hasVoted","Login","App","basename","path","exact","component","Boolean","hostname","ReactDOM","render","Provider","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"mHAAA,46D,4QCGaA,EAAiB,SAACC,GAE3B,OAAoB,IAAbA,EAAEC,SAAiBD,EAAEE,SAAS,MAG5BC,EAAkB,SAACC,GAC5B,OAAOA,EAAMC,WAAaC,KAAKC,OAGtBC,EAAQ,SAACC,GAAD,IAAcC,EAAd,uDAA+B,MAAOC,EAAtC,uCAAkDC,EAAlD,8CACjBC,MAAMJ,EAAK,CACPG,SACAF,SACAI,YAAa,UACbC,QAAS,CAAE,eAAgB,oBAC3BJ,KAAMA,EAAOK,KAAKC,UAAUN,QAAQO,IAEnCC,KAAKC,GACLC,MAAMC,QAAQC,QAEvB,SAAeH,EAAeI,GAA9B,SAAAC,EAAAC,OAAA,mDAC4B,MAApBF,EAASG,OADjB,sBAEc,IAAIC,MAAM,gBAAkBJ,EAASG,QAFnD,yBAAAF,EAAA,MAIiBD,EAASK,QAJ1B,6EAmBO,IAAMC,EAAU,SAACC,EAAYC,GAChC,IAAIC,EAAQC,IACRF,EAAMC,EAAME,KAAKJ,GAChBE,EAAQA,EAAMG,QAAO,SAAAC,GAAC,OAAIA,IAAMN,KACrCO,aAAaC,QAAQC,IAAcxB,KAAKC,UAAUgB,KAGzCC,EAAW,WACpB,IAAMD,EAAQK,aAAaG,QAAQD,KACnC,OAAKP,EAIEjB,KAAK0B,MAAMT,IAHdU,IACO,KAKTA,EAAoB,WACtBL,aAAaC,QAAQC,IAAcxB,KAAKC,UAAU,MAG/C,SAAS2B,EAA0BC,GACtC,IAAMC,EAAUC,KAAKC,MAAMH,EAAS,KAC9BI,EAAUF,KAAKC,MAAOH,EAAS,IAAS,KAC9C,OAAmB,KAAZI,EAAA,UAAoBH,EAAU,EAA9B,iBAA0CA,EAA1C,aAAsDG,EAAU,GAAK,IAAM,IAAMA,K,uOC9CrF,IAAMC,EAAoB,SAACC,EAAeC,GAAmB,IAAD,EACrCC,mBAAS,IAD4B,mBACxDC,EADwD,KACjDC,EADiD,KAEzDC,EAhBH,SAAqBC,EAAeC,GAAgB,IAAD,EACVL,mBAASI,GADC,mBAC/CE,EAD+C,KAC/BC,EAD+B,KAWtD,OATAC,qBAAU,WACN,IAAMC,EAAUC,YAAW,WACvBH,EAAkBH,KACnBC,GACH,OAAO,WACHM,aAAaF,MAElB,CAACL,EAAOC,IAEJC,EAKgBM,CAAYX,EAAO,KAiB1C,OANAO,qBAAU,WACFL,GAAkBF,EAAMrD,OAAS,GACjCkD,EAASK,KAEd,CAACA,IAEG,CAAEF,QAAOC,WAAUW,kBAfA,SAACC,GACT,KAAVb,GAAgBa,EAAEC,OAAOX,MAAMxD,OAAS,EACxCkD,EAASgB,EAAEC,OAAOX,OACe,IAA1BU,EAAEC,OAAOX,MAAMxD,QACtBmD,IAEJG,EAASY,EAAEC,OAAOX,UAYbY,EAAY,WAAO,IAAD,EACWhB,mBAAS,IADpB,mBACpBiB,EADoB,KACPC,EADO,OAEOlB,oBAAS,GAFhB,mBAEpBmB,EAFoB,KAETC,EAFS,KAGrBC,EAAMC,mBAENC,EAASC,6BACX,SAAOC,EAAaC,GAApB,SAAAtD,EAAAC,OAAA,mDACwB,IAAhBqD,EAAK9E,OADb,yCAEe,IAFf,gCAIeyE,EAAIM,cAAcD,EAAMD,IAJvC,uCAOA,CAACR,IAGCW,EAAqBC,uBAAY,WACnCX,EAAe,IACfE,GAAa,GACbG,EAAOO,UACR,CAACP,IAmBJ,OAZAf,qBAAU,WACN,IAAMuB,EAAsB,SAACjB,GACX,WAAVA,EAAEkB,KAAoBb,GACtBS,KAIR,OADAK,SAASC,iBAAiB,UAAWH,GAC9B,WACHE,SAASE,oBAAoB,UAAWJ,MAE7C,CAACZ,EAAWS,IAER,CAAET,YAAWiB,aAAcR,EAAoBS,aAjB3B,SAACpC,GACxBiB,EAAejB,GACVkB,GAAWC,GAAa,IAeuDG,WAK/Ee,EAAe,SAAC5D,GACzB,IAAM2C,EAAMC,mBACNiB,EAAQC,IACRC,EAAUC,cAHwB,EAIF1C,mBAAiB,GAJf,mBAIjC2C,EAJiC,KAIpBC,EAJoB,KAwBxC,OAlBApC,qBAAU,WAKN,OAJAa,EAAIwB,iBAAiBnE,GAAIZ,MAAK,SAAAgF,GACtBA,EAASzB,EAAI0B,aAAajF,KAAKyE,EAAMS,WACpCP,EAAQ3D,KAAK,iBAEf,kBAAMuC,EAAI4B,iBAClB,CAAC5B,EAAKoB,EAAS/D,EAAI6D,EAAMS,YAE5BxC,qBAAU,WACN,IAAM0C,EAAY,CACdN,eAAgB,SAACO,GAAD,OAAeP,EAAeO,IAC9CC,gBAAiBb,EAAMc,aACvBC,qBAAsBf,EAAMgB,iBAC5B5E,KAAM4D,EAAMiB,OAEhBnC,EAAIoC,WAAW/E,EAAIwE,KACpB,CAACX,EAAMc,aAAcd,EAAMgB,iBAAkBlC,EAAK3C,EAAI6D,EAAMiB,QAExD,CAAEb,cAAaJ,UAkBbC,EAAW,WAAO,IAAD,EACExC,mBAAsB,IADxB,mBACnB0D,EADmB,KACXV,EADW,OAfb,WAAO,IAAD,EACOhD,mBAAmB,IAD1B,mBACZpB,EADY,KACL+E,EADK,KAEnBnD,qBAAU,WACNmD,EAAS9E,wBACV,IAQH,MAAO,CAAED,QAAO+E,SANM,SAACjF,EAAYC,GACrBgF,EAANhF,EAAe,GAAD,mBAAKC,GAAL,CAAYF,IAChBE,EAAMG,QAAO,SAAAC,GAAC,OAAIA,IAAMN,MACtCkF,kBAAiBlF,EAAIC,KAQGkF,GAApBjF,EAFkB,EAElBA,MAAO+E,EAFW,EAEXA,SACTtC,EAAMC,mBA0CZ,MAAO,CAIHoC,OAAQA,EAASA,EAAOI,MAAK,SAAC1F,EAAG2F,GAAJ,OAAUA,EAAEnF,MAAQR,EAAEQ,SAAS,GAC5DoF,WA7C0B,SAACC,GAC3B5C,EAAI6C,kBAAkBD,EAAMvF,IAAIZ,MAAK,SAAAY,GACjCuF,EAAME,SAAWzF,EACjBsE,EAAU,GAAD,mBAAKU,GAAL,CAAaO,KACtBN,EAASjF,GAAI,OA0CjB2E,aAtC4B,SAACY,GAC7BjB,EAAU,GAAD,mBAAKU,GAAL,CAAaO,MAsCtBG,gBAnC+B,SAAC1F,GAChC2C,EAAIgD,uBAAuB3F,GAC3BsE,EAAUU,EAAO3E,QAAO,SAAAuF,GAAC,OAAIA,EAAEH,WAAazF,MAC5CiF,EAASjF,GAAI,IAiCb6E,iBA9BgC,SAAC7E,GACjCT,QAAQsG,IAAI,uBAAwB7F,GACpCsE,EAAUU,EAAO3E,QAAO,SAAAuF,GAAC,OAAIA,EAAEH,WAAazF,OA6B5CC,KA1BuB,SAACD,GAAsC,IAA1BC,IAAyB,yDAC7D0C,EAAImD,eAAe9F,EAAIC,GACvB,IAAM8F,EAAI,YAAOf,GACXgB,EAAQD,EAAKE,WAAU,SAAAL,GAAC,OAAIA,EAAEH,WAAazF,KACjD+F,EAAKC,GAAO9F,MAAQ6F,EAAKC,GAAO9F,OAASD,EAAO,GAAK,GACrDqE,EAAUyB,GACVd,EAASjF,EAAIC,IAqBb6E,MAlB+B,SAAC7E,GAAyC,IACjED,EAAcC,EAAdD,GAAIE,EAAUD,EAAVC,MACN6F,EAAI,YAAOf,GACXgB,EAAQD,EAAKE,WAAU,SAAAL,GAAC,OAAIA,EAAEH,WAAazF,KACjD+F,EAAKC,GAAO9F,MAAQA,EACpBoE,EAAUyB,IAcV7F,QACAoE,cAIK4B,EAAc,SAACC,EAAsBxE,GAC9C,IAAMyE,EAAgBC,kBAAO,eAE7BvE,qBAAU,WACNsE,EAAcE,QAAUH,IACzB,CAACA,IAEJrE,qBAAU,WAIN,GAAc,OAAVH,EAAgB,CAChB,IAAI3B,EAAKuG,aAJb,WACIH,EAAcE,YAGa3E,GAC3B,OAAO,kBAAM6E,cAAcxG,OAEhC,CAAC2B,M,8BC3MR,sMAAO,IAAM8E,EAAQ,IACRC,EAAO,YACPC,EAAQ,SACRC,EAAO,YACPC,EAAW,a,gCCJxB,8wBACO,IAAMC,EAAmDC,qCACnDC,EAAqDD,kCACrDE,EAAWH,EAAW,OACtBI,EAAaJ,EAAW,SACxBK,EAAoBL,EAAW,WAC/BM,EAAgBN,EAAW,YAC3BO,EAAoBP,EAAW,QAC/BQ,EAAoBR,EAAW,UAC/BS,EAAgBT,EAAW,YAC3BU,EAAyBV,EAAW,eACpCW,EAA8BX,EAAW,oBACzCY,EAAWZ,EAAW,OAItBa,EAAoCC,6CACpCC,EAA0BD,uCAC1BE,EAA0BD,EAA0B,QACpDE,EAA2BF,EAA0B,SACrDG,EAAgCH,EAA0B,QAC1DI,EAAoCJ,EAA0B,YAC9DK,EAA0BL,EAA0B,QACpDM,EAAiCN,EAA0B,WAC3DO,EAAgCP,EAGhCQ,EAAqB,qBACrB5H,EAAe,QACf6H,EAAoB,qB,sHCpBpBC,EAIT,aAAe,yBAHfC,UAGc,OAFdC,YAEc,OAKdC,QAAU,aALI,KAOdC,UAAY,aANRC,KAAKJ,MAAO,EACZI,KAAKH,OAAS,IAQTI,E,OAAcC,EAAMC,cAAwB,IAAIR,I,sLCMhDS,EAOT,aAAe,IAAD,gCANdC,QAMc,OALdC,UAKc,OAJdC,YAIc,OAHdC,YAGc,OAFdC,eAEc,OAQdC,QAAU,WACN,EAAKL,GAAK,IAAIM,UAAUvC,cAExB,EAAKiC,GAAGO,OAAS,WACbjK,QAAQsG,IAAI,gBAGhB,EAAKoD,GAAGQ,QAAU,SAACC,GACfnK,QAAQsG,IAAI,eAAgB6D,GAC5B,EAAKT,GAAK,KACVjH,WAAW,EAAK2H,MAAO,MAG3B,EAAKV,GAAGW,QAAU,SAACC,GACftK,QAAQC,MAAM,eAAgBqK,GAC9B,EAAKZ,GAAGa,UAvBF,KA2BdH,MAAQ,YAEA,EAAKN,WAAe,EAAKJ,IAAM,EAAKA,GAAGc,aAAeR,UAAUS,QAAS,EAAKV,WA7BxE,KAgCdW,KAAO,WACHxL,gBAAMiJ,aAjCI,KAoCdwC,cAAgB,SAACC,EAAcC,GAC3B,IAAMC,EAnDE,SAACF,EAAcC,GAC3B,OAAOnL,KAAKC,UAAU,CAClBiL,OACAC,YAgDgBE,CAAQH,EAAMC,GACxBG,EAAWhE,aAAY,WACrB,EAAK0C,IAAM,EAAKA,GAAGc,aAAeR,UAAUiB,OAC5C,EAAKvB,GAAGwB,KAAKJ,GACb7D,cAAc+D,MAEnB,MA3CO,KA8CdxF,WAAa,SAAC/E,EAAY0K,GACjB,EAAKzB,IAAI,EAAKK,UAEnB,EAAKL,GAAG0B,UAAY,SAACvI,GACjB,IAAMiI,EAAUpL,KAAK0B,MAAMyB,EAAEwI,MAC7B,OAAQP,EAAQF,MACZ,IAAK,YACD,MACJ,IAAK,iBAGL,IAAK,QACDO,EAAGxG,eAAemG,EAAQD,SAC1B,MACJ,IAAK,aACDM,EAAGhG,gBAAgB2F,EAAQD,SAC3B,MACJ,IAAK,eACDM,EAAG9F,qBAAqByF,EAAQD,SAChC,MACJ,IAAK,OACDM,EAAGzK,KAAKoK,EAAQD,WAO5B,EAAKhB,OAASpJ,EAET,EAAKqJ,YACN,EAAKa,cAAc,OAAQlK,GAC3B,EAAKqJ,WAAY,IA9EX,KAkFd9E,YAAc,WACV,EAAK8E,WAAY,EACjB,EAAKD,OAAS,GACd,EAAKH,GAAGa,SArFE,KAwFde,gBAAkB,WACd,OAAO,IAAIC,SAAQ,SAAAC,GACf,IAAM1M,EAAsBY,KAAK0B,MAAMJ,aAAaG,QAAQ2H,uBAE5D,GAAIhK,IAAUD,0BAAgBC,GAC1B,OAAO0M,GAAQ,GACZ,GAAI1M,GAASD,0BAAgBC,GAChC,OAAO,EAAK2M,mBAAmB3M,GAAOe,KAAK2L,GAG/C,IAEIE,EAAO9B,OAAO+B,OAAOC,MAAQ,EAAIA,IACjCC,EAAMjC,OAAO+B,OAAOG,OAAS,EAAIA,IAE/BC,EAAQnC,OAAOoC,KACjBpC,OAAOqC,SAASC,KAChB,UACA,+EARU,IAQV,mBAPS,IAOT,gBACqCL,EADrC,iBACiDH,IAGrD,OAAOxM,gBAAM2I,gBAAe,OAAOhI,MAAK,SAACsM,GACjCJ,GACAA,EAAME,SAASG,QAAQD,EAAId,MAC3BzB,OAAM,cAAoB,WAEtB,OADAmC,EAAMxB,QACCiB,GAAQ,KAGnBa,MAAM,yEAtHR,KA4HdC,iBAAmB,SAACC,GAChB,OAAOrN,gBAAM,GAAD,OAAI4I,oBAAJ,iBAA8ByE,IACrC1M,MAAK,SAAAsM,GAAG,OAAIA,EAAId,QAChBxL,MAAK,SAAAf,GACFA,EAAMC,WAAaC,KAAKC,MAA2B,IAAnBH,EAAM0N,WACtCxL,aAAaC,QAAQ6H,qBAAoBpJ,KAAKC,UAAUb,QAjItD,KAqId2M,mBAAqB,SAAC3M,GAClB,OAAOI,gBAAM,GAAD,OAAI6I,oBAAJ,0BAAuCjJ,EAAM2N,gBAAiB5M,MACtE,SAACsM,GACG,IAAMO,EAAWP,EAAId,KAIrB,OAHAqB,EAASD,cAAgB3N,EAAM2N,cAC/BC,EAAS3N,WAAaC,KAAKC,MAA8B,IAAtByN,EAASF,WAC5CxL,aAAaC,QAAQ6H,qBAAoBpJ,KAAKC,UAAU+M,IACjDA,MA5IL,KAiJdC,YAAc,0BAAAxM,EAAAC,OAAA,kEAAAD,EAAA,MAC+BjB,gBAAMwI,aADrC,cACJxH,EADI,OAEV,EAAKyJ,MAAO,EACZ,EAAKI,UAHK,kBAIH7J,EAASmL,MAJN,sCAjJA,KAwJdzG,iBAAmB,SAAOnE,GAAP,SAAAN,EAAAC,OAAA,wDACR3B,yBAAegC,IADP,uCAAAN,EAAA,MACsBjB,gBAAM,GAAD,OAAI0I,oBAAJ,eAA4BnH,KADvD,mBACoF4K,KADpF,4EAxJL,KA4Jd3H,cAAgB,SAAOJ,EAAgBhE,GAAvB,iBAAAa,EAAAC,OAAA,uDACNwM,EAAQtJ,EAAO8I,QAAQ,IAAK,KADtB,WAAAjM,EAAA,MAEkCjB,gBAAM,GAAD,OAAIyI,aAAJ,kBAAwBiF,GAAS,MAAO,KAAMtN,IAFrF,cAENY,EAFM,yBAGLA,EAASmL,MAHJ,sCA5JF,KAkKdvG,WAAa,0BAAA3E,EAAAC,OAAA,kEAAAD,EAAA,MACiDjB,gBAAM,GAAD,OAAI8I,gBAAJ,eAAwB,EAAK6B,UADnF,cACH3J,EADG,yBAEFA,EAASmL,KAAK5F,QAFZ,sCAlKC,KAuKdQ,kBAAoB,SAAOxF,GAAP,eAAAN,EAAAC,OAAA,kEAAAD,EAAA,MACyBjB,gBAAM,GAAD,OACvC+I,yBADuC,oBACLxH,EADK,sBACW,EAAKoJ,QAC1D,QAHY,cACV3J,EADU,yBAKTA,EAASmL,MALA,sCAvKN,KA+KdjF,uBAAyB,SAAO3F,GAAP,SAAAN,EAAAC,OAAA,gDACrBlB,gBAAM,GAAD,OAAIgJ,8BAAJ,oBAA2CzH,EAA3C,sBAA2D,EAAKoJ,QAAU,UAD1D,sCA/KX,KAmLdtD,eAAiB,SAAO9F,EAAYC,GAAnB,SAAAP,EAAAC,OAAA,gDACb,EAAKuK,cAAc,OAAQ,CAAElK,KAAIC,OAAMmM,KAAM,EAAKhD,SADrC,sCAlLbR,KAAKO,OAAS,KACdP,KAAKQ,OAAS,GACdR,KAAKS,WAAY,EACjBT,KAAKK,GAAK,KACVL,KAAKM,MAAO,GAmLPmD,EAAavD,IAAMC,cAAuB,IAE1CnG,EAAS,kBAAe0J,qBAAWD,K,2GCxMnCE,EAOT,WAAY5J,GAAe,IAAD,gCAN1B6J,oBAM0B,OAL1BnO,WAK0B,OAJ1BsE,SAI0B,OAH1B8J,qBAG0B,OAF1BC,qBAE0B,OAS1BC,gBAAkB,SAACC,GACf,EAAKH,gBAAkBG,EACvB,EAAKC,eAAeD,GACpB,EAAKJ,eAAiBrD,OAAO5C,aAAY,kBAAM,EAAKsG,eAAeD,KArBnD,MASM,KAe1BE,aAAe,WACP,EAAKN,gBAAgBhG,cAAc,EAAKgG,iBAhBtB,KAmB1BK,eAAiB,SAACD,GACd,EAAKG,QAAQlF,0BAAyB,IAAIzI,KAAKwN,IApBzB,KAuB1BI,WAAa,WAIT,OAAO,EAAKD,QAAQ5E,iCAHL,CACXxJ,OAAQ,QAEgDS,MACxD,SAACsM,GAAD,OAAyCA,EAAIuB,YA5B3B,KAgC1BC,UAAY,SAAClN,GACT,IAAMmN,EAAS,CACXxO,OAAQ,MACRC,KAAMK,KAAKC,UAAU,CACjBkO,WAAY,CAACpN,MAGrB,OAAO,EAAK+M,QAAQ3E,gCAA+B+E,IAvC7B,KA0C1BE,UAAY,SAACrN,EAAYyF,GACrB,IAAM0H,EAAS,CACXxO,OAAQ,MACRC,KAAMK,KAAKC,UAAU,CACjBoO,KAAM,CAAC,iBAAD,OAAkBtN,OAIhC,EAAK0M,gBAAgBa,QACrB,EAAKb,gBAAkB,IAAIc,gBAE3B,EAAKT,QAAQjF,0BAAyBqF,GAAQ/N,MAAK,WAC/C4C,YAAW,kBAAM,EAAK6K,eAAe,EAAKJ,mBAAkB,QAE5DhH,GAAU,EAAK9C,IAAIgD,uBAAuBF,IAxDxB,KA2D1BgI,iBAAmB,WACf,IAAMzN,EAAKO,aAAaG,QAAQ4H,qBAI1B5J,EAAG,UAAMiJ,oCAAN,wBAAuD3H,EAAvD,YACT,EAAK+M,QAAQrO,EAJE,CACXC,OAAQ,QAGcS,MAAK,YAA0C,IAAvC4F,EAAsC,EAAtCA,OAC1BA,GAAUA,EAAO9G,OAAS,GAC1B,EAAKmP,UAAUrI,EAAO,GAAGhF,QAnEX,KAyE1B0N,YAAc,WAA2B,IAA1Bd,IAAyB,yDAC9BlO,EAAMkO,EAAO5E,gCAAgCC,oCAC7CkF,EAAS,CACXxO,OAAQ,QAEZ,EAAKoO,QAAQrO,EAAKyO,IA9EI,KAiF1BQ,eAAiB,SAACC,GACd,IAAMlP,EAAMkP,EAAY7F,2BAA2BD,0BAInD,EAAKiF,QAAQrO,EAHE,CACXC,OAAQ,SApFU,KAyF1BkP,mBAAqB,SAACC,GAClB,IAAMpP,EAAG,UAAMwJ,0BAAN,wBAA6C4F,GAEtD,EAAKf,QAAQrO,EADE,CAAEC,OAAQ,SA3FH,KA+F1BoP,aAAe,WAEX,OADAxO,QAAQsG,IAAI,iBAAkB,EAAKxH,OAC5B,EAAKsE,IAAIqI,mBAAmB,EAAK3M,OAAOe,MAAK,SAAAf,GAChD,EAAKA,MAAQA,MAlGK,KAsG1B0O,QAAU,SAACrO,EAAayO,GACpB,OAAI,EAAK9O,OAASD,0BAAgB,EAAKC,OAC5B,EAAK0P,eAAe3O,MAAK,kBAAM,EAAK2N,QAAQrO,EAAKyO,MAErDrO,MAAMJ,EAAD,aACRM,QAAS,CACLgP,cAAc,UAAD,OAAY,EAAK3P,MAAM4P,gBAErCd,EAJK,CAKRtO,OAAQ,EAAK6N,gBAAgB7N,UAE5BO,MAAK,SAAAsM,GAEF,OADmB,MAAfA,EAAI9L,QAAgBL,QAAQC,MAAMkM,EAAI5L,QACvB,MAAf4L,EAAI9L,OAAuB8L,EAAI5L,OACvB4L,KAEfpM,OAAM,SAAAuK,GAAG,OAAItK,QAAQC,MAAM,oCAAqCqK,OArHrE,IAAMxL,EAAsBY,KAAK0B,MAAMJ,aAAaG,QAAQ2H,uBAC5DO,KAAKvK,MAAQA,EACbuK,KAAK4D,eAAiB,KACtB5D,KAAK6D,gBAAkB,KACvB7D,KAAKjG,IAAMA,EACXiG,KAAK8D,gBAAkB,IAAIc,iBAoHtBU,EAAa,WAIpB,IAAD,EACuC5M,oBAAS,GADhD,mBACM6M,EADN,KACoBC,EADpB,KAEKzL,EAAMC,mBACNyL,EAAUC,mBAAQ,kBAAM,IAAI/B,EAAc5J,KAAM,CAACA,IAHtD,EAIqCrB,mBAClC,IALH,mBAIMiN,EAJN,KAImBC,EAJnB,KAeD,OARA1M,qBAAU,WAMN,OALAuM,EAAQ1B,iBAAgB,SAAC8B,GACjBN,GAAcC,GAAgB,GAClCI,EAAeC,GACXA,EAAMC,MAAMnO,aAAaC,QAAQ8H,oBAAmBmG,EAAMC,KAAK1O,OAEhEqO,EAAQvB,eAChB,IACI,CAAEyB,cAAaI,WAAYN,EAASO,SAAUT,K,mCC1KzDU,EAAOC,QAAU,IAA0B,yC,weCY9BC,G,MAA0B,SAAC,GAAgD,IAA9CC,EAA6C,EAA7CA,KAAMC,EAAuC,EAAvCA,MAAOC,EAAgC,EAAhCA,eAAgBlP,EAAgB,EAAhBA,GAC7D+D,EAAUC,cAChB,OACI,yBAAKmL,UAAW,UAAYF,EAAQ,IAAMD,GACtC,wBAAIG,UAAU,cAAcC,QAASrL,EAAQsL,QAA7C,SAGCrP,GACG,wBAAImP,UAAU,eAAd,SACU,4CADV,qBACgD,2BAAInP,GAAQ,KAG/DkP,GACG,yBAAKC,UAAU,sBACVD,EADL,IACqB,kBAAC,EAAD,UCdxBI,G,MAA0B,SAAC,GAM1B,IALVF,EAKS,EALTA,QAKS,IAJTjF,YAIS,MAJF,QAIE,MAHTzI,aAGS,MAHD,GAGC,MAFT6N,eAES,aADTJ,iBACS,MADG,GACH,EACT,OACI,4BAAQC,QAASA,EAASD,UAAW,iBAAmBhF,EAAO,IAAMgF,GACjE,6BAAMI,EAAU,kBAAC,EAAD,MAAW7N,MCf1B8N,G,MAA+B,WACxC,OACI,yBAAKL,UAAU,OACX,kBAAC,EAAD,CAAQF,MAAM,QAAQD,KAAK,MAC3B,sCCPCS,G,MAAO,kBAChB,yBAAKN,UAAU,gBACX,8BACA,8BACA,8BACA,iCCNKO,EAAQ,kBACjB,yBAAKC,QAAQ,cAAcR,UAAU,aACjC,0BAAMS,EAAE,wJAIHC,EAAO,kBAChB,yBAAKF,QAAQ,cAAcR,UAAU,aACjC,0BAAMS,EAAE,iDACR,0BAAME,EAAE,UAAUC,EAAE,KAAK5E,MAAM,UAAUE,OAAO,UAI3C2E,EAAW,kBACpB,yBAAKL,QAAQ,cAAcR,UAAU,aACjC,0BAAMS,EAAE,2DACR,0BAAME,EAAE,UAAUC,EAAE,MAAM5E,MAAM,UAAUE,OAAO,MAAM4E,UAAU,+BAI5DC,EAAU,kBACnB,yBAAKJ,EAAE,MAAMC,EAAE,MAAMJ,QAAQ,cAAcR,UAAU,aACjD,2BACI,2BACI,2BACI,0BACIS,EAAE,uRAIN,0BACIA,EAAE,ghBAMN,0BACIA,EAAE,4dAQlB,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,8BAIKO,EAAU,kBACnB,yBAAKR,QAAQ,cAAcR,UAAU,gBACjC,0BACIS,EAAE,0EACFQ,YAAY,IACZC,eAAe,UAEnB,0BAAMP,EAAE,KAAKC,EAAE,KAAK5E,MAAM,KAAKE,OAAO,KAAKiF,GAAG,IAAIF,YAAY,MAC9D,0BAAMR,EAAE,aAAaQ,YAAY,MACjC,4BAAQG,GAAG,KAAKC,GAAG,KAAKC,EAAE,KAAKL,YAAY,MAC3C,4BAAQG,GAAG,KAAKC,GAAG,KAAKC,EAAE,IAAItB,UAAU,gBA4CnCuB,EAAU,kBACnB,yBAAKf,QAAQ,cACT,0BAAMG,EAAE,KAAKC,EAAE,KAAK5E,MAAM,KAAKE,OAAO,KAAKiF,GAAG,IAAIF,YAAY,MAC9D,4BAAQG,GAAG,KAAKC,GAAG,KAAKC,EAAE,KAAKL,YAAY,MAC3C,4BAAQG,GAAG,KAAKC,GAAG,KAAKC,EAAE,IAAItB,UAAU,gBAInCwB,EAAQ,kBACjB,yBAAKhB,QAAQ,cACT,0BAAMG,EAAE,KAAKC,EAAE,KAAK5E,MAAM,KAAKE,OAAO,KAAKiF,GAAG,IAAIF,YAAY,MAC9D,4BAAQG,GAAG,KAAKC,GAAG,KAAKC,EAAE,IAAItB,UAAU,gBAInCyB,EAAW,kBACpB,yBAAKjB,QAAQ,eACT,0BAAMG,EAAE,KAAKC,EAAE,KAAK5E,MAAM,MAAME,OAAO,MAAMiF,GAAG,IAAIF,YAAY,MAChE,0BAAMR,EAAE,cAAcQ,YAAY,QAI7BS,EAAO,kBAChB,yBAAKf,EAAE,MAAMC,EAAE,MAAMJ,QAAQ,sBAAsBR,UAAU,aACzD,0BACIS,EAAE,sRAIN,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,8BAIKkB,EAAQ,kBACjB,yBAAKhB,EAAE,MAAMC,EAAE,MAAMJ,QAAQ,oBAAoBR,UAAU,aACvD,2BACI,0BACIS,EAAE,uKAGN,0BACIA,EAAE,2KAIV,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,4BACA,8BAIKmB,EAAa,WACtB,OACI,yBAAKC,iBAAiB,kBAAkBrB,QAAQ,eAC5C,2BACI,0BACIC,EAAE,iLACFqB,KAAK,OACLC,OAAO,OACPC,cAAc,QACdd,eAAe,QACfe,iBAAiB,KACjBhB,YAAY,OAEhB,0BACIR,EAAE,4DACFqB,KAAK,OACLC,OAAO,OACPC,cAAc,QACdd,eAAe,QACfe,iBAAiB,KACjBhB,YAAY,OAEhB,0BACIR,EAAE,sDACFqB,KAAK,OACLC,OAAO,OACPC,cAAc,QACdd,eAAe,QACfe,iBAAiB,KACjBhB,YAAY,UAOnBiB,EAAQ,kBACjB,yBAAK1B,QAAQ,eACT,0BAAMC,EAAE,mOAIH0B,EAAe,kBACxB,yBAAK3B,QAAQ,eACT,0BAAMC,EAAE,kb,8BChOH2B,G,MAAyB,SAAC,GAAiC,EAA/BC,SAAgC,IAAtBzN,EAAqB,EAArBA,QACzCpB,EAAMC,mBADwD,EAG1CtB,mBAAS,IAHiC,mBAG7D9B,EAH6D,KAGtDiS,EAHsD,OAItCnQ,oBAAS,GAJ6B,mBAI7DiO,EAJ6D,KAIpDmC,EAJoD,KAMpE5P,qBAAU,WAENa,EAAIsH,SACL,CAACtH,IAyBJ,OACI,yBAAKwM,UAAU,SACX,wBAAIA,UAAU,YAAd,SACA,yBAAKA,UAAU,iBACX,kBAAC,EAAD,CAAMqC,SA3BK,oBAAA9R,EAAAC,OAAA,gDACnBJ,QAAQsG,IAAI,kBACZlD,EAAIkI,kBACCzL,MAAK,0BAAAM,EAAAC,OAAA,uDACFJ,QAAQsG,IAAI,eADV,WAAAnG,EAAA,MAEeiD,EAAIuJ,eAFnB,OAEIlM,EAFJ,OAGF+D,EAAQ3D,KAAKuR,SAAO/K,KAAK+E,QAAQ,MAAO3L,IAHtC,wCAKLV,OAAM,SAAAuK,GACH4H,EA9BG,sCAqBQ,wCA4BX,kBAAC,EAAD,CAAMD,SAfK,SAAOxR,GAAP,SAAAN,EAAAC,OAAA,uDACnB+R,GAAW,GADQ,WAAAhS,EAAA,MAETiD,EAAIwB,iBAAiBnE,IAFZ,kCAGf+D,EAAQ3D,KAAKuR,SAAOjL,KAAKiF,QAAQ,MAAO3L,IAHzB,sBAKf0R,GAAW,GACXD,EAzCU,kCAmCK,sCAeqBlC,QAASA,KAE5C/P,GAAS,yBAAK2P,UAAU,eAAe3P,MCnDvCoS,EAAwB,SAAC,GAAyB,IAAvBJ,EAAsB,EAAtBA,SAAsB,EAC1BlQ,oBAAS,GADiB,mBACnDuQ,EADmD,KACxCH,EADwC,KAQ1D,OAAO,kBAAC,EAAD,CAAQtC,QALK,WAChBsC,GAAW,GACXF,KAGiC9P,MAAM,OAAOyI,KAAK,cAAcoF,QAASsC,KCNrEC,EAAwB,SAAC,GAAkC,IAAhCN,EAA+B,EAA/BA,SAAUjC,EAAqB,EAArBA,QAAqB,EACzCjO,mBAAiB,IADwB,mBAC5DC,EAD4D,KACrDC,EADqD,OAE3BF,oBAAkB,GAFS,mBAE5DyQ,EAF4D,KAE9CC,EAF8C,KAG7DC,EAAU5L,iBAAuB9C,SAAS2O,cAAc,QAExDC,EAAehP,uBAAY,WACzB4O,GAAgBxQ,EAAMrD,OAAS,EAC/BsT,EAASjQ,GAETyQ,GAAgB,KAErB,CAACD,EAAcxQ,EAAOiQ,IAEnBY,EAAqBjP,uBACvB,SAACf,IACQ6P,EAAQ3L,QAAQ+L,SAASjQ,EAAEC,SAAmB0P,GAC/CC,GAAgB,KAGxB,CAACD,IAGCO,EAAqBnP,uBACvB,SAACf,GACiB,UAAVA,EAAEkB,KACF6O,MAGR,CAACA,IAYL,OATArQ,qBAAU,WAGN,OAFAyB,SAASC,iBAAiB,QAAS4O,GACnC7O,SAASC,iBAAiB,UAAW8O,GAC9B,WACH/O,SAASE,oBAAoB,QAAS2O,GACtC7O,SAASE,oBAAoB,UAAW6O,MAE7C,CAACA,EAAoBF,IAGpB,yBAAKG,IAAKN,EAAS9C,UAAW,eAAiB4C,EAAe,QAAU,KACpE,kBAAC,EAAD,CACI5C,UAAWI,EAAU,UAAY,GACjCH,QAAS+C,EACTzQ,MAAOqQ,EAAe,SAAW,OACjC5H,KAAK,UAET,kBAAC,EAAD,CAAWqI,SAAUhR,EAAUiR,YAAY,YAAY/Q,MAAOH,EAAOmR,QAASX,MC/C7EY,G,MAA6B,SAAC,GAA8D,IAA5DH,EAA2D,EAA3DA,SAAU9Q,EAAiD,EAAjDA,MAAiD,IAA1CgR,eAA0C,aAA5BD,mBAA4B,MAAhB,GAAgB,EACpG,OACI,2BACItD,UAAWuD,EAAU,qBAAuB,aAC5CvI,KAAK,OACLzI,MAAOA,EACP8Q,SAAU,SAACpQ,GACPoQ,EAASpQ,EAAEC,OAAOX,QAEtB+Q,YAAaA,MCbZG,EAAoC,SAAAC,GAC7C,IAAMlQ,EAAMC,mBAUZ,OARAd,qBAAU,WACN,IACMgK,EADQ,IAAIgH,gBAAgBD,EAAMrH,SAAS3I,QAC9BkQ,IAAI,QACvBpQ,EAAIkJ,iBAAiBC,GAAM1M,MAAK,WAC5B+J,OAAO6J,OAAOC,gBACd9J,OAAOW,aAEZ,CAACnH,EAAKkQ,EAAMrH,WACR,+BCPE0H,G,MAAqC,SAAC,GAA6C,IAA3C7R,EAA0C,EAA1CA,SAAU8R,EAAgC,EAAhCA,eAAgB1Q,EAAgB,EAAhBA,UACrE2Q,EAAW/M,iBAAyB9C,SAAS2O,cAAc,UAD0B,EAE5C/Q,4BAAkBgS,EAAgB9R,GAAzEE,EAFmF,EAEnFA,MAAOC,EAF4E,EAE5EA,SAAUW,EAFkE,EAElEA,kBAFkE,EAG9Db,oBAAS,GAHqD,mBAGpF+R,EAHoF,KAG1EC,EAH0E,KAKrFC,EAAepQ,uBAAY,WAC7BiQ,EAAS9M,QAAQkN,OACjBhS,EAAS,IACTH,MACD,CAACA,EAAUG,IAERiS,EAAmBtQ,uBACrB,SAACf,GACiB,WAAVA,EAAEkB,KACFiQ,MAGR,CAACA,IAkBL,OAfAzR,qBAAU,WACN,IAAMwE,EAAU8M,EAAS9M,QAGzB,OAFAA,EAAQ9C,iBAAiB,UAAWiQ,GAE7B,WACHnN,EAAQ7C,oBAAoB,UAAWgQ,MAE5C,CAACA,IAEJ3R,qBAAU,YACDW,GAAalB,EAAMrD,OAAS,GAC7BsD,EAAS,OAKb,yBAAK2N,UAAU,gBACX,2BACIoD,IAAKa,EACLM,SAAU,EACVC,QAAS,kBAAML,GAAS,IACxBM,OAAQ,kBAAMN,GAAS,IACvBd,SAAUrQ,EACVT,MAAOH,EACP4I,KAAK,OACLsI,YAAY,YAEdhQ,GAAa4Q,IAAa,4BAAQjE,QAASmE,GAAjB,a,cCtCjC,IAAMM,EAA6C,SAAC,GAIjC,IAHtB7O,EAGqB,EAHrBA,OACA8O,EAEqB,EAFrBA,WACAC,EACqB,EADrBA,cACqB,EACmBzS,mBAAS0D,EAAOgP,KAAI,SAAApO,GAAC,OAAIA,EAAE5F,OAD9C,mBACdiU,EADc,KACAC,EADA,KAGrBpS,qBAAU,WACNoS,EAAgBC,MAAMnP,EAAO9G,QAAQ+S,MAAK,MAC3C,CAACjM,IAaJ,OACI,yBAAKmK,UAAU,kBACX,wBAAIA,UAAU,6BACTnK,EAAOgP,KAAI,SAACzO,EAAOS,GAAR,OACR,wBAAI1C,IAAKiC,EAAME,UACX,yBAAK2O,KAzCTC,EAyCyB9O,EAAM+O,QAxC3CD,EAAMnW,OAAS,EACRmW,EAEAE,EAAQ,KAqCsCC,IAAI,KACzC,yBAAKrF,UAAU,eACX,6BACI,4BAAK5J,EAAMkP,QAEf,6BAAMlP,EAAMmP,SAEhB,4BAAQtF,QAAS,kBAvBd,SAACpJ,GAChBiO,EAAajO,GACb+N,EAAc/O,EAAOgB,GAAOP,UAE5BqO,EAAW9O,EAAOgB,IAEtB,IAAMD,EAAI,YAAOkO,GACjBlO,EAAKC,IAAUD,EAAKC,GACpBkO,EAAgBnO,GAeuB4O,CAAe3O,KAClC,6BAAMiO,EAAajO,GAAS,kBAAC,EAAD,MAAY,kBAAC,EAAD,SAjDpE,IAAoBqO,Q,QCKPO,G,MAA0B,SAAC,GAAyB,IAAvBC,EAAsB,EAAtBA,SAAUhR,EAAY,EAAZA,MAAY,EACFvB,sBAAlDG,EADoD,EACpDA,UAAWkB,EADyC,EACzCA,aAAcD,EAD2B,EAC3BA,aAAcb,EADa,EACbA,OAC/C,OACI,yBAAKsM,UAAU,UACX,kBAAC,EAAD,CAAagE,eAAgBxP,EAActC,SAAUqC,EAAcjB,UAAWA,IAC7EA,EACGI,EAAO0M,QACH,kBAAC,cAAD,CAASuF,IAAK,oBAAqB9F,KAAM,GAAIC,MAAO,UACpDpM,EAAOkS,QAAUlS,EAAOkS,OAAO7W,OAAS,EACxC,kBAAC,EAAD,CACI4V,WAAYjQ,EAAMyB,WAClByO,cAAelQ,EAAM6B,gBACrBV,OAAQnC,EAAOkS,SAGnB,yCAGJF,KCdHjD,G,MAAwB,SAACiB,GAAkB,IAAD,EACpBjP,uBAAaiP,EAAMmC,MAAMC,OAAOjV,IAAvDiE,EAD2C,EAC3CA,YAAaJ,EAD8B,EAC9BA,MAD8B,EAELqK,uBAAtCK,EAF2C,EAE3CA,YAAaI,EAF8B,EAE9BA,WAAYC,EAFkB,EAElBA,SAEjC,OACI,yBAAKO,UAAU,QACX,kBAAC,EAAD,CAAQF,MAAM,QAAQD,KAAK,IAAIE,eAAgBjL,EAAajE,GAAI6S,EAAMmC,MAAMC,OAAOjV,KACnF,yBAAKmP,UAAU,gBACX,kBAAC,GAAD,CAAQnK,OAAQnB,EAAMmB,OAAQuJ,YAAaA,EAAaI,WAAYA,EAAYC,SAAUA,IAC1F,kBAAC,EAAD,CAAQ/K,MAAOA,GACX,kBAAC,EAAD,CAAWmB,OAAQnB,EAAMmB,OAAQkQ,SAAUrR,EAAM6B,gBAAiByP,OAAQxG,EAAWtB,iBCb5F+H,G,MAAsC,SAAC,GAAkD,IAAhDpQ,EAA+C,EAA/CA,OAAQkQ,EAAuC,EAAvCA,SAAUC,EAA6B,EAA7BA,OACpE,OACI,wBAAIhG,UAAU,mBACV,4BACI,sCACA,uCACA,uCAEHnK,EAAO9G,OAAS,EACb8G,EAAOgP,KAAI,SAACzO,EAAOS,GAAR,OACP,wBAAI1C,IAAKiC,EAAME,SAAU0J,UAAU,mBAC/B,6BAAM5J,EAAMkP,OACZ,6BAAMlP,EAAMmP,QACZ,6BAAMnP,EAAMrF,OACZ,4BAAQkP,QAAS,kBAAM+F,EAAO5P,EAAMvF,GAAIuF,EAAME,YAC1C,kBAAC,EAAD,OAEJ,4BAAQ2J,QAAS,kBAAM8F,EAAS3P,EAAME,YAClC,kBAAC,EAAD,WAKZ,4BACI,sD,iBC/Bd4P,G,MAAU,CACZC,YAAa,IACbC,MAAO,IACPC,IAAK,IAOIC,EAAyB,SAAC,GAAoB,IAAlBrB,EAAiB,EAAjBA,IAC/BsB,EAAOrP,iBAAuB9C,SAAS2O,cAAc,QAM3D,OAJApQ,qBAAU,WACN6T,IAAYC,KAAKF,EAAKpP,QAAS+O,MAI/B,yBAAK9C,IAAKmD,EAAMvG,UAAU,cACtB,yBAAKiF,IAAKA,EAAKI,IAAI,oBCjBlBqB,G,MAAkC,SAAC,GAAkB,IAAhBjH,EAAe,EAAfA,SAAe,EACvBtN,mBAASsN,GADc,mBACtDkH,EADsD,KACzCC,EADyC,KAO7D,OAJAjU,qBAAU,WACNE,YAAW,kBAAM+T,GAAe,KAAQ,OACzC,CAACnH,IAEGkH,EAAc,yBAAK3G,UAAW,0BAA4BP,EAAW,GAAK,eAAuB,OCN/FoH,EAAgD,SAAC,GAA4C,IAA1C7L,EAAyC,EAAzCA,KAAMiF,EAAmC,EAAnCA,QAC5D6G,EAAqB,SAAT9L,GAA4B,UAATA,EAiBrC,OACI,4BAAQiF,QAASA,EAASD,UAAW,0BAA4BhF,GAAQ8L,EAAY,UAAY,KAjBlF,WACf,OAAQ9L,GACJ,IAAK,OACD,OAAO,kBAAC,EAAD,MACX,IAAK,OACD,OAAO,kBAAC,EAAD,MACX,IAAK,OACD,OAAO,kBAAC,EAAD,MACX,IAAK,QACD,OAAO,kBAAC,EAAD,MACX,IAAK,UACD,OAAO,kBAAC,EAAD,MACX,IAAK,UACD,OAAO,kBAAC,EAAD,OAKV+L,KCnBAC,EAA8B,SAAC,GAA0B,IAAxBlJ,EAAuB,EAAvBA,QAASmC,EAAc,EAAdA,QAcnD,OACI,6BACI,4BACKnC,EAAQ/O,OAAS,EACd+O,EAAQ+G,KAAI,SAACoC,EAAQpQ,GAAT,OACR,wBAAI1C,IAAK8S,EAAOpW,IACZ,4BACImP,UACIiH,EAAOC,cAAgB,oBAAsBD,EAAOE,UAAY,gBAAkB,GAEtFC,SAAUH,EAAOC,cACjBjH,QAAS,kBAAMA,EAAQgH,EAAOpW,MAxB1C,SAACmK,GACb,OAAQA,GACJ,IAAK,WACD,OAAO,kBAAC,EAAD,MACX,IAAK,UACD,OAAO,kBAAC,EAAD,MACX,IAAK,aACD,OAAO,kBAAC,EAAD,MACX,QACI,OAAO,kBAAC,EAAD,OAiBUqM,CAAQJ,EAAOjM,MAChB,2BAAIiM,EAAOK,WAKvB,wBAAItH,UAAU,WACV,kBAAC,cAAD,CAASH,KAAM,GAAIC,MAAO,cCjCrCyH,EAA8C,SAAC,GAAoB,IAAlB/H,EAAiB,EAAjBA,WAAiB,EACzCrN,oBAAS,GADgC,mBACpEqV,EADoE,KACzDC,EADyD,OAE7CtV,mBAAS,IAFoC,mBAEpE2L,EAFoE,KAE3D4J,EAF2D,KAwB3E,OARA/U,qBAAU,WACN,IAAIgV,GAAU,EAId,OAHAnI,EAAW3B,aAAa5N,MAAK,SAAA6N,GACrB6J,GAASD,EAAW5J,MAErB,kBAAO6J,GAAU,KACzB,CAACnI,EAAW3B,WAAY2B,IAGvB,yBAAKQ,UAAU,2BACVwH,GAAa,kBAAC,EAAD,CAAO1J,QAASA,EAASmC,QAjBpB,SAACpP,GACxB2O,EACKzB,UAAUlN,GACVZ,KAAKuP,EAAW3B,YAChB5N,KAAKyX,MAcN,kBAAC,EAAD,CAAgBzH,QAvBE,WACjBuH,GAAWhI,EAAW3B,aAAa5N,KAAKyX,GAC7CD,GAAcD,IAqBkCxM,KAAK,c,eCtBhD4M,EAA0C,SAAC,GAM/B,IALrBzQ,EAKoB,EALpBA,QACApI,EAIoB,EAJpBA,OACA0P,EAGoB,EAHpBA,UACAoJ,EAEoB,EAFpBA,OACAC,EACoB,EADpBA,MACoB,EACY3V,mBAASgF,GADrB,mBACb4Q,EADa,KACHC,EADG,KAGdC,EAAS,CAEXjM,MAAM,GAAD,OAAM,IAAM+L,EAAYhZ,EAAxB,MAGTgI,aAAY,WACR,GAAI0H,EAAW,CACX,IAAMhB,EAAOsK,EAAW,IAlBrB,IAmBCtK,EAAO1O,EAAQiZ,EAAYvK,EAnB5B,MAqBCuK,EAAY,GACZF,QAGT,KAEHnV,qBAAU,WACFoV,EAAW,GAAKtJ,GAChBuJ,EAAY7Q,KAEjB,CAACA,EAASpI,IAYb,OACI,yBAAKiR,UAAU,0BACX,6BAAMtO,YAA0BqW,IAChC,yBAAK/H,UAAU,eAAeC,QAbd,SAAChN,GACrB,IAAMiV,EAAcjV,EAAEkV,cAChBC,EAAmBF,EAAYG,YAE/BC,GAD2BrV,EAAEsV,QAAUL,EAAYM,wBAAwB1M,MACnBsM,EACxDK,EAAe5W,KAAK6W,MAAMJ,EAA6BvZ,GAC7D8Y,EAAOY,GACPT,EAAYS,KAOJ,yBAAKE,MAAOV,KAEhB,6BAAMvW,YAA0B3C,MCnD/B6Z,EAAwD,SAAC,GAAoB,IAAlBpJ,EAAiB,EAAjBA,WACpE,OACI,yBAAKQ,UAAU,qBACX,yBAAKA,UAAU,+BACX,kBAAC,EAAD,CAAgBC,QAAS,aAAUjF,KAAK,YACxC,kBAAC,EAAD,CAAgBiF,QAAS,aAAUjF,KAAK,SACxC,kBAAC,EAAD,CAAgBiF,QAAS,aAAUjF,KAAM,SACzC,kBAAC,EAAD,CAAgBiF,QAAS,aAAUjF,KAAK,SACxC,kBAAC,EAAD,CAAewE,WAAYA,KAE/B,kBAAC,EAAD,CAAaf,WAAW,EAAO1P,OAAQ,EAAGoI,QAAS,EAAG0Q,OAAQ,SAAClJ,KAAmBmJ,MAAO,iBAWxFe,EAAwC,SAAC,GAAmC,IAAjCvJ,EAAgC,EAAhCA,MAAOE,EAAyB,EAAzBA,WAAY3J,EAAa,EAAbA,OAAa,EAClD1D,mBAASmN,EAAMwJ,YADmC,mBAC7ErK,EAD6E,KAClEsK,EADkE,KAGpFpW,qBAAU,WACNoW,EAAazJ,EAAMwJ,cACpB,CAACxJ,EAAMwJ,aAEV,IAKME,EAAsB,WACpBnT,EAAO9G,OAAS,EAChByQ,EAAWtB,UAAUrI,EAAO,GAAGhF,GAAIgF,EAAO,GAAGS,UAE7CkJ,EAAWlB,oBAInB,OACI,yBAAK0B,UAAU,qBACX,yBAAKA,UAAU,+BACX,kBAAC,EAAD,CAAgBC,QAAS,kBAAM7P,QAAQsG,IAAI8I,IAAaxE,KAAK,YAC7D,kBAAC,EAAD,CAAgBiF,QAAS,kBAAMT,EAAWjB,aAAY,IAAQvD,KAAK,SACnE,kBAAC,EAAD,CAAgBiF,QAlBC,WACzBT,EAAWhB,eAAeC,GAC1BsK,GAActK,IAgByCzD,KAAMyD,EAAY,QAAU,SAC3E,kBAAC,EAAD,CAAgBwB,QAAS+I,EAAqBhO,KAAK,SACnD,kBAAC,EAAD,CAAewE,WAAYA,KAE/B,kBAAC,EAAD,CACIf,UAAWA,EACX1P,OAAQuQ,EAAMC,KAAK0J,YACnB9R,QAASmI,EAAM4J,YACfrB,OAAQrI,EAAWd,mBACnBoJ,MAAOkB,MC1DjBG,GAAoB,CACtBlE,IAAKG,EAAQ,IACbG,OAAQ,SACRnP,MAAO,SAUEgT,GAAgC,SAAC,GAAmD,IAAjDvT,EAAgD,EAAhDA,OAAQuJ,EAAwC,EAAxCA,YAAaI,EAA2B,EAA3BA,WAAYC,EAAe,EAAfA,SACvE4J,EAAiBjK,GAAe,eAAgBA,GAAeA,EAAYG,KAC3EnJ,EAAK,OAAGgJ,QAAH,IAAGA,OAAH,EAAGA,EAAaG,KAE3B,OACI,oCACI,kBAAC,EAAD,CAASE,SAAUA,IACnB,yBAAKO,UAAU,UACVqJ,EACG,oCACI,kBAAC,EAAD,CAAOpE,IAAK7O,EAAM8O,MAAMoE,OAAO,GAAG/Z,MAClC,4BAAK6G,EAAMmT,QAAQ,GAAGjC,MACtB,2BAAIlR,EAAMkR,MACV,kBAAC,EAAD,CAAYzR,OAAQA,EAAQyJ,MAAOF,EAAaI,WAAYA,KAGhE,oCACI,kBAAC,EAAD,CAAOyF,IAAKkE,GAAkBlE,MAC9B,4BAAKkE,GAAkB5D,QACvB,2BAAI4D,GAAkB/S,OACtB,kBAAC,EAAD,CAAoBoJ,WAAYA,QC1B3CgK,I,MAA6B7P,IAAM8P,MAAK,YAAgB,IAAb5D,EAAY,EAAZA,MAAY,EACjCpR,uBAAaoR,EAAMC,OAAOjV,IAAjDiE,EADwD,EACxDA,YAAaJ,EAD2C,EAC3CA,MAErB,OACI,yBAAKsL,UAAU,aACX,kBAAC,EAAD,CAAQF,MAAM,QAAQD,KAAK,IAAIE,eAAgBjL,IAC/C,kBAAC,EAAD,CAAQJ,MAAOA,GACX,kBAAC,GAAD,CAAWgV,OAAQhV,EAAM5D,KAAMC,MAAO2D,EAAM3D,MAAO8E,OAAQnB,EAAMmB,eCVpEoQ,I,MAAsC,SAAC,GAA+C,IAA7CpQ,EAA4C,EAA5CA,OAAQ9E,EAAoC,EAApCA,MAAO2Y,EAA6B,EAA7BA,OACjE,OACI,yBAAK1J,UAAU,kBACX,wBAAIA,UAAU,cACTnK,EAAOgP,KAAI,SAACzO,EAAOS,GAChB,IAAM8S,EAAW5Y,EAAM/B,SAASoH,EAAME,UACtC,OACI,wBAAInC,IAAKiC,EAAME,UACX,yBAAK2O,IAAK7O,EAAM+O,QAASE,IAAI,KAC7B,yBAAKrF,UAAU,eACX,6BACI,4BAAK5J,EAAMkP,QAEf,6BAAMlP,EAAMmP,SAEhB,6BACI,6BACKnP,EAAMrF,MADX,QACuC,IAAhBqF,EAAMrF,OAAe,KAE5C,4BAAQkP,QAAS,kBAAMyJ,EAAOtT,EAAME,UAAWqT,KAC1CA,EAAW,kBAAC,EAAD,MAAY,kBAAC,EAAD,gBCzB/CC,I,MAAyB,WAClC,OACI,yBAAK5J,UAAU,SACX,kBAAC,EAAD,CAAQF,MAAM,QAAQD,KAAK,MAC3B,wC,kBC4BGgK,I,MAnBO,WAClB,OACI,yBAAK7J,UAAU,OACX,kBAAC,KAAD,CAAQ8J,SAAUlS,IACd,kBAAC,IAAD,KACI,kBAAC,IAAD,CAAOmS,KAAMvH,SAAcwH,OAAK,EAACC,UAAW7H,IAC5C,kBAAC,IAAD,CAAO2H,KAAMvH,SAAcwH,OAAK,EAACC,UAAWL,KAC5C,kBAAC,IAAD,CAAOG,KAAMvH,QAAawH,OAAK,EAACC,UAAWT,KAC3C,kBAAC,IAAD,CAAOO,KAAMvH,QAAawH,OAAK,EAACC,UAAWxH,IAC3C,kBAAC,IAAD,CAAOsH,KAAMvH,YAAiBwH,OAAK,EAACC,UAAWxG,IAC/C,kBAAC,IAAD,KACI,kBAAC,EAAD,YClBJyG,QACW,cAA7BlQ,OAAOqC,SAAS8N,UAEe,UAA7BnQ,OAAOqC,SAAS8N,UAEhBnQ,OAAOqC,SAAS8N,SAAStE,MACvB,2DCVNuE,IAASC,OACL,kBAAC,aAAWC,SAAZ,CAAqB/X,MAAO,IAAIsH,OAC5B,kBAAC,cAAYyQ,SAAb,CAAsB/X,MAAO,IAAI6G,QAC7B,kBAAC,GAAD,QAGRhF,SAASmW,eAAe,SD6HtB,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMza,MAAK,SAAA0a,GACjCA,EAAaC,kB","file":"static/js/main.7b2d2834.chunk.js","sourcesContent":["import * as ROUTES from './routes'\nexport { useSpotify, SpotifyPlayer } from './spotify'\nexport { ROUTES }\nexport { useAuth, Auth, AuthContext } from './auth'\nexport { useAPI, APIContext, API } from './api'\nexport { validateRoomID, Fetch, tokenHasExpired, getVotes, setVote, millisToMinutesAndSeconds } from './helpers'\nexport { useDebounce, useDebouncedInput, useSearch, useWebSocket, useQueue, useInterval } from './hooks'\n\nexport * from './constants'\nexport * from './types'\n","import { SpotifyToken } from './types'\nimport { VOTED_TRACKS } from './constants'\n\nexport const validateRoomID = (s: string): boolean => {\n    // return s.length === 6 && Number.isInteger(Number(s.substr(1, 6))) && !s.includes(' ')\n    return s.length === 6 && !s.includes(' ')\n}\n\nexport const tokenHasExpired = (token: SpotifyToken): boolean => {\n    return token.expires_on < Date.now()\n}\n\nexport const Fetch = (url: string, method: string = 'GET', body?: any, signal?: AbortSignal) =>\n    fetch(url, {\n        signal,\n        method,\n        credentials: 'include',\n        headers: { 'Content-Type': 'application/json' },\n        body: body ? JSON.stringify(body) : undefined,\n    })\n        .then(gatherResponse)\n        .catch(console.error)\n\nasync function gatherResponse(response: any): Promise<any> {\n    if (response.status !== 200) {\n        throw new Error('Bad status = ' + response.status)\n    }\n    return await response.json()\n\n    // const { headers } = response\n    // const contentType = headers.get('content-type')\n    // if (contentType.includes('application/json')) {\n    //     return await response.json()\n    // } else if (contentType.includes('application/text')) {\n    //     return await response.json()\n    // } else if (contentType.includes('text/html')) {\n    //     return await response.json()\n    // } else {\n    //     return await response.json()\n    // }\n}\n\nexport const setVote = (id: string, vote: boolean) => {\n    let votes = getVotes()\n    if (vote) votes.push(id)\n    else votes = votes.filter(v => v !== id)\n    localStorage.setItem(VOTED_TRACKS, JSON.stringify(votes))\n}\n\nexport const getVotes = () => {\n    const votes = localStorage.getItem(VOTED_TRACKS)\n    if (!votes) {\n        setupLocalStorage()\n        return []\n    }\n    return JSON.parse(votes)\n}\n\nconst setupLocalStorage = () => {\n    localStorage.setItem(VOTED_TRACKS, JSON.stringify([]))\n}\n\nexport function millisToMinutesAndSeconds(millis) {\n    const minutes = Math.floor(millis / 60000)\n    const seconds = Math.floor((millis % 60000) / 1000)\n    return seconds === 60 ? `${minutes + 1}:00` : `${minutes}:${(seconds < 10 ? '0' : '') + seconds}`\n}\n","import { useState, useEffect, useRef, useCallback } from 'react'\nimport { useAsyncAbortable } from 'react-async-hook'\nimport { useHistory } from 'react-router-dom'\nimport { useAPI, TrackType, getVotes, setVote as setVoteInStorage } from '.'\n\nexport function useDebounce(value: string, delay: number) {\n    const [debouncedValue, setDebouncedValue] = useState(value)\n    useEffect(() => {\n        const handler = setTimeout(() => {\n            setDebouncedValue(value)\n        }, delay)\n        return () => {\n            clearTimeout(handler)\n        }\n    }, [value, delay])\n\n    return debouncedValue\n}\n\nexport const useDebouncedInput = (onUpdate: any, onCancel: any) => {\n    const [input, setInput] = useState('')\n    const debouncedInput = useDebounce(input, 400)\n\n    const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        if (input === '' && e.target.value.length > 0) {\n            onUpdate(e.target.value)\n        } else if (e.target.value.length === 0) {\n            onCancel()\n        }\n        setInput(e.target.value)\n    }\n\n    useEffect(() => {\n        if (debouncedInput && input.length > 0) {\n            onUpdate(debouncedInput)\n        }\n    }, [debouncedInput])\n\n    return { input, setInput, handleInputChange }\n}\n\nexport const useSearch = () => {\n    const [searchInput, setSearchInput] = useState('')\n    const [searching, setSearching] = useState(false)\n    const api = useAPI()\n\n    const search = useAsyncAbortable(\n        async (abortSignal, text) => {\n            if (text.length === 0) {\n                return []\n            } else {\n                return api.doSearchTrack(text, abortSignal)\n            }\n        },\n        [searchInput],\n    )\n\n    const handleCancelSearch = useCallback(() => {\n        setSearchInput('')\n        setSearching(false)\n        search.reset()\n    }, [search])\n\n    const handleSearchUpdate = (input: string) => {\n        setSearchInput(input)\n        if (!searching) setSearching(true)\n    }\n\n    useEffect(() => {\n        const handleEscapePressed = (e: KeyboardEvent) => {\n            if (e.key === 'Escape' && searching) {\n                handleCancelSearch()\n            }\n        }\n        document.addEventListener('keydown', handleEscapePressed)\n        return () => {\n            document.removeEventListener('keydown', handleEscapePressed)\n        }\n    }, [searching, handleCancelSearch])\n\n    return { searching, cancelSearch: handleCancelSearch, searchUpdate: handleSearchUpdate, search }\n}\n\nexport const useRoomValidation = () => {}\n\nexport const useWebSocket = (id: string) => {\n    const api = useAPI()\n    const queue = useQueue()\n    const history = useHistory()\n    const [subscribers, setSubscribers] = useState<number>(1)\n\n    useEffect(() => {\n        api.doValidateRoomID(id).then(isValid => {\n            if (isValid) api.doGetQueue().then(queue.setTracks)\n            else history.push('/not-found')\n        })\n        return () => api.doLeaveRoom()\n    }, [api, history, id, queue.setTracks])\n\n    useEffect(() => {\n        const callbacks = {\n            setSubscribers: (n: number) => setSubscribers(n),\n            addTrackToQueue: queue.addedToQueue,\n            removeTrackFromQueue: queue.removedFromQueue,\n            vote: queue.voted,\n        }\n        api.doJoinRoom(id, callbacks)\n    }, [queue.addedToQueue, queue.removedFromQueue, api, id, queue.voted])\n\n    return { subscribers, queue }\n}\n\nconst useVotes = () => {\n    const [votes, setVotes] = useState<string[]>([])\n    useEffect(() => {\n        setVotes(getVotes())\n    }, [])\n\n    const handleSetVote = (id: string, vote: boolean) => {\n        if (vote) setVotes([...votes, id])\n        else setVotes(votes.filter(v => v !== id))\n        setVoteInStorage(id, vote)\n    }\n\n    return { votes, setVotes: handleSetVote }\n}\n\nexport const useQueue = () => {\n    const [tracks, setTracks] = useState<TrackType[]>([])\n    const { votes, setVotes } = useVotes()\n    const api = useAPI()\n\n    const handleAddTrackToQueue = (track: TrackType) => {\n        api.doAddTrackToQueue(track.id).then(id => {\n            track.queue_id = id\n            setTracks([...tracks, track])\n            setVotes(id, true)\n        })\n    }\n\n    const handleTrackAddedToQueue = (track: TrackType) => {\n        setTracks([...tracks, track])\n    }\n\n    const handleRemoveTrackFromQueue = (id: string) => {\n        api.doRemoveTrackFromQueue(id)\n        setTracks(tracks.filter(t => t.queue_id !== id))\n        setVotes(id, false)\n    }\n\n    const handleTrackRemovedFromQueue = (id: string) => {\n        console.log('Removing from queue:', id)\n        setTracks(tracks.filter(t => t.queue_id !== id))\n    }\n\n    const handleVoteForTrack = (id: string, vote: boolean = true) => {\n        api.doVoteForTrack(id, vote)\n        const copy = [...tracks]\n        const index = copy.findIndex(t => t.queue_id === id)\n        copy[index].votes = copy[index].votes + (vote ? 1 : -1)\n        setTracks(copy)\n        setVotes(id, vote)\n    }\n\n    const handleReceivedVoteForTrack = (vote: { id: string; votes: number }) => {\n        const { id, votes } = vote\n        const copy = [...tracks]\n        const index = copy.findIndex(t => t.queue_id === id)\n        copy[index].votes = votes\n        setTracks(copy)\n    }\n\n    return {\n        // Probably anti-pattern to sort here, right?\n        // The queue can be sorted from firebase,\n        // but needs to be re-sorted on each vote\n        tracks: tracks ? tracks.sort((a, b) => b.votes - a.votes) : [],\n        addToQueue: handleAddTrackToQueue,\n        addedToQueue: handleTrackAddedToQueue,\n        removeFromQueue: handleRemoveTrackFromQueue,\n        removedFromQueue: handleTrackRemovedFromQueue,\n        vote: handleVoteForTrack,\n        voted: handleReceivedVoteForTrack,\n        votes,\n        setTracks,\n    }\n}\n\nexport const useInterval = (callback: () => void, delay: number) => {\n    const savedCallback = useRef(() => {})\n\n    useEffect(() => {\n        savedCallback.current = callback\n    }, [callback])\n\n    useEffect(() => {\n        function tick() {\n            savedCallback.current()\n        }\n        if (delay !== null) {\n            let id = setInterval(tick, delay)\n            return () => clearInterval(id)\n        }\n    }, [delay])\n}\n","export const START = '/'\nexport const ROOM = '/room/:id'\nexport const LOGIN = '/login'\nexport const HOST = '/host/:id'\nexport const REDIRECT = '/redirect'\n\n// export type routeType = START | ROOM | LOGIN\n","/* URLs */\nexport const BASE_URL = process.env.NODE_ENV === 'production' ? process.env.REACT_APP_BASE_URL : 'http://localhost:8081/'\nexport const SOCKET_URL = process.env.NODE_ENV === 'production' ? process.env.REACT_APP_WS_URL : 'ws://localhost:8081'\nexport const HOST_URL = BASE_URL + 'host'\nexport const SEARCH_URL = BASE_URL + 'search'\nexport const VALIDATE_ROOM_URL = BASE_URL + 'validate'\nexport const AUTHORIZE_URL = BASE_URL + 'authorize'\nexport const REQUEST_TOKEN_URL = BASE_URL + 'token'\nexport const REFRESH_TOKEN_URL = BASE_URL + 'refresh'\nexport const GET_QUEUE_URL = BASE_URL + 'get-queue'\nexport const ADD_TRACK_TO_QUEUE_URL = BASE_URL + 'add-to-queue'\nexport const REMOVE_TRACK_FROM_QUEUE_URL = BASE_URL + 'remove-from-queue'\nexport const PING_URL = BASE_URL + 'ping'\n\n/* Spotify API */\nexport const SPOIFY_BASE_URL = 'https://api.spotify.com/v1'\nexport const SPOTIFY_PLAYER_RECOMMENDATION_URL = SPOIFY_BASE_URL + '/recommendations'\nexport const SPOTIFY_PLAYER_BASE_URL = SPOIFY_BASE_URL + '/me/player'\nexport const SPOTIFY_PLAYER_PLAY_URL = SPOTIFY_PLAYER_BASE_URL + '/play'\nexport const SPOTIFY_PLAYER_PAUSE_URL = SPOTIFY_PLAYER_BASE_URL + '/pause'\nexport const SPOTIFY_PLAYER_NEXT_TRACK_URL = SPOTIFY_PLAYER_BASE_URL + '/next'\nexport const SPOTIFY_PLAYER_PREVIOUS_TRACK_URL = SPOTIFY_PLAYER_BASE_URL + '/previous'\nexport const SPOTIFY_PLAYER_SEEK_URL = SPOTIFY_PLAYER_BASE_URL + '/seek'\nexport const SPOTIFY_PLAYER_GET_DEVICES_URL = SPOTIFY_PLAYER_BASE_URL + '/devices'\nexport const SPOTIFY_PLAYER_SET_DEVICE_URL = SPOTIFY_PLAYER_BASE_URL\n\n/* Localstorage */\nexport const SPOTIFY_USER_TOKEN = 'spotify_user_token'\nexport const VOTED_TRACKS = 'votes'\nexport const LAST_PLAYED_TRACK = 'last_played_track'\n","import React, { useContext } from 'react'\n\nexport interface AuthType {\n    auth: boolean\n    roomId: string\n    doLogin: () => void\n    doSignOut: () => void\n}\n\nexport class Auth implements AuthType {\n    auth: boolean\n    roomId: string\n\n    constructor() {\n        this.auth = false\n        this.roomId = ''\n    }\n\n    doLogin = () => {}\n\n    doSignOut = () => {}\n}\n\nexport const AuthContext = React.createContext<AuthType>(new Auth())\n\nexport const useAuth = () => useContext(AuthContext)\n\nexport default AuthContext\n","import React, { useContext } from 'react'\nimport {\n    SOCKET_URL,\n    AUTHORIZE_URL,\n    REQUEST_TOKEN_URL,\n    SPOTIFY_USER_TOKEN,\n    REFRESH_TOKEN_URL,\n    GET_QUEUE_URL,\n    ADD_TRACK_TO_QUEUE_URL,\n    REMOVE_TRACK_FROM_QUEUE_URL,\n    HOST_URL,\n    VALIDATE_ROOM_URL,\n    SEARCH_URL,\n    PING_URL,\n    validateRoomID,\n    Fetch,\n    TrackType,\n    tokenHasExpired,\n    SpotifyToken,\n    APIType,\n} from '.'\n\nconst Message = (type: string, payload: string | object): string => {\n    return JSON.stringify({\n        type,\n        payload,\n    })\n}\n\nexport class API implements APIType {\n    ws: WebSocket\n    host: boolean\n    window: Window | null\n    roomID: string\n    inSession: boolean\n\n    constructor() {\n        this.window = null\n        this.roomID = ''\n        this.inSession = false\n        this.ws = null\n        this.host = false\n    }\n\n    connect = () => {\n        this.ws = new WebSocket(SOCKET_URL)\n\n        this.ws.onopen = () => {\n            console.log('Open socket')\n        }\n\n        this.ws.onclose = (par: any) => {\n            console.log('Close socket', par)\n            this.ws = null\n            setTimeout(this.check, 1000)\n        }\n\n        this.ws.onerror = (err: any) => {\n            console.error('Socket error', err)\n            this.ws.close()\n        }\n    }\n\n    check = () => {\n        /* check if websocket instance is closed, if so call `connect` function. */\n        if (this.inSession && (!this.ws || this.ws.readyState === WebSocket.CLOSED)) this.connect()\n    }\n\n    ping = () => {\n        Fetch(PING_URL)\n    }\n\n    doSendMessage = (type: string, payload: string | object) => {\n        const message = Message(type, payload)\n        const interval = setInterval(() => {\n            if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n                this.ws.send(message)\n                clearInterval(interval)\n            }\n        }, 1000)\n    }\n\n    doJoinRoom = (id: string, cb: any) => {\n        if (!this.ws) this.connect()\n\n        this.ws.onmessage = (e: any) => {\n            const message = JSON.parse(e.data)\n            switch (message.type) {\n                case 'spectator':\n                    break\n                case 'numSubscribers':\n                    cb.setSubscribers(message.payload as number)\n                    break\n                case 'leave':\n                    cb.setSubscribers(message.payload as number)\n                    break\n                case 'trackAdded':\n                    cb.addTrackToQueue(message.payload as TrackType)\n                    break\n                case 'trackRemoved':\n                    cb.removeTrackFromQueue(message.payload as string)\n                    break\n                case 'vote':\n                    cb.vote(message.payload as { votes: number; id: string })\n                    break\n                default:\n                    break\n            }\n        }\n\n        this.roomID = id\n\n        if (!this.inSession) {\n            this.doSendMessage('join', id)\n            this.inSession = true\n        }\n    }\n\n    doLeaveRoom = () => {\n        this.inSession = false\n        this.roomID = ''\n        this.ws.close()\n    }\n\n    doAuthorizeUser = () => {\n        return new Promise(resolve => {\n            const token: SpotifyToken = JSON.parse(localStorage.getItem(SPOTIFY_USER_TOKEN))\n\n            if (token && !tokenHasExpired(token)) {\n                return resolve(true)\n            } else if (token && tokenHasExpired(token)) {\n                return this.doRefreshUserToken(token).then(resolve)\n            }\n\n            const width = 450,\n                height = 730,\n                left = window.screen.width / 2 - width / 2,\n                top = window.screen.height / 2 - height / 2\n\n            const popup = window.open(\n                window.location.href,\n                'Spotify',\n                'menubar=no,location=no,resizable=no,scrollbars=no,status=no,width=' +\n                    `${width},height=${height},top=${top},left=${left}`,\n            )\n\n            return Fetch(AUTHORIZE_URL, 'GET').then((res: { data: string }) => {\n                if (popup) {\n                    popup.location.replace(res.data)\n                    window['tokenCallback'] = () => {\n                        popup.close()\n                        return resolve(true)\n                    }\n                } else {\n                    alert('Hey, you! This app needs popups, sorry. Just allow them. Once.')\n                }\n            })\n        })\n    }\n\n    doFetchUserToken = (code: string) => {\n        return Fetch(`${REQUEST_TOKEN_URL}?code=${code}`)\n            .then(res => res.data)\n            .then(token => {\n                token.expires_on = Date.now() + token.expires_in * 1000\n                localStorage.setItem(SPOTIFY_USER_TOKEN, JSON.stringify(token))\n            })\n    }\n\n    doRefreshUserToken = (token: SpotifyToken) => {\n        return Fetch(`${REFRESH_TOKEN_URL}?refresh_token=${token.refresh_token}`).then(\n            (res: { data: SpotifyToken }) => {\n                const newToken = res.data\n                newToken.refresh_token = token.refresh_token\n                newToken.expires_on = Date.now() + newToken.expires_in * 1000\n                localStorage.setItem(SPOTIFY_USER_TOKEN, JSON.stringify(newToken))\n                return newToken\n            },\n        )\n    }\n\n    doSetupRoom = async (): Promise<string> => {\n        const response: { data: string } = await Fetch(HOST_URL)\n        this.host = true\n        this.connect()\n        return response.data\n    }\n\n    doValidateRoomID = async (id: string): Promise<boolean> => {\n        return validateRoomID(id) && ((await Fetch(`${VALIDATE_ROOM_URL}?id=${id}`)) as { data: boolean }).data\n    }\n\n    doSearchTrack = async (search: string, signal: AbortSignal): Promise<TrackType[]> => {\n        const query = search.replace(' ', '+')\n        const response: { data: TrackType[] } = await Fetch(`${SEARCH_URL}?query=${query}`, 'GET', null, signal)\n        return response.data\n    }\n\n    doGetQueue = async (): Promise<TrackType[]> => {\n        const response: { data: { tracks: TrackType[] } } = await Fetch(`${GET_QUEUE_URL}?id=${this.roomID}`)\n        return response.data.tracks\n    }\n\n    doAddTrackToQueue = async (id: string): Promise<string> => {\n        const response: { data: string } = await Fetch(\n            `${ADD_TRACK_TO_QUEUE_URL}?trackID=${id}&sessionID=${this.roomID}`,\n            'PUT',\n        )\n        return response.data\n    }\n\n    doRemoveTrackFromQueue = async (id: string) => {\n        Fetch(`${REMOVE_TRACK_FROM_QUEUE_URL}?trackID=${id}&sessionID=${this.roomID}`, 'DELETE')\n    }\n\n    doVoteForTrack = async (id: string, vote: boolean) => {\n        this.doSendMessage('vote', { id, vote, room: this.roomID })\n    }\n}\n\nexport const APIContext = React.createContext<APIType>({} as APIType)\n\nexport const useAPI = (): APIType => useContext(APIContext)\n","import { useState, useEffect, useMemo } from 'react'\nimport {\n    SPOTIFY_USER_TOKEN,\n    SPOTIFY_PLAYER_BASE_URL,\n    SPOTIFY_PLAYER_PLAY_URL,\n    SPOTIFY_PLAYER_PAUSE_URL,\n    SPOTIFY_PLAYER_NEXT_TRACK_URL,\n    SPOTIFY_PLAYER_PREVIOUS_TRACK_URL,\n    SPOTIFY_PLAYER_SEEK_URL,\n    SpotifyToken,\n    useAPI,\n    tokenHasExpired,\n    APIType,\n    SPOTIFY_PLAYER_RECOMMENDATION_URL,\n    TrackType,\n    LAST_PLAYED_TRACK,\n    SPOTIFY_PLAYER_GET_DEVICES_URL,\n    SPOTIFY_PLAYER_SET_DEVICE_URL,\n} from '.'\n\nconst POLLING_TIMEOUT = 5000\n\nexport class SpotifyPlayer {\n    playerInterval: null | number\n    token: SpotifyToken\n    api: APIType\n    pollingCallback: null | ((state: SpotifyApi.CurrentPlaybackResponse) => void)\n    abortController: AbortController\n\n    constructor(api: APIType) {\n        const token: SpotifyToken = JSON.parse(localStorage.getItem(SPOTIFY_USER_TOKEN))\n        this.token = token\n        this.playerInterval = null\n        this.pollingCallback = null\n        this.api = api\n        this.abortController = new AbortController()\n    }\n\n    pollPlayerState = (next: (state: SpotifyApi.CurrentPlaybackResponse) => void) => {\n        this.pollingCallback = next\n        this.getPlayerState(next)\n        this.playerInterval = window.setInterval(() => this.getPlayerState(next), POLLING_TIMEOUT)\n    }\n\n    clearPolling = () => {\n        if (this.playerInterval) clearInterval(this.playerInterval)\n    }\n\n    getPlayerState = (next: (state: SpotifyApi.CurrentPlaybackResponse) => void) => {\n        this.request(SPOTIFY_PLAYER_BASE_URL, {}).then(next)\n    }\n\n    getDevices = (): Promise<SpotifyApi.UserDevice[]> => {\n        const config = {\n            method: 'GET',\n        }\n        return this.request(SPOTIFY_PLAYER_GET_DEVICES_URL, config).then(\n            (res: SpotifyApi.UserDevicesResponse) => res.devices,\n        )\n    }\n\n    setDevice = (id: string): Promise<any> => {\n        const config = {\n            method: 'PUT',\n            body: JSON.stringify({\n                device_ids: [id],\n            }),\n        }\n        return this.request(SPOTIFY_PLAYER_SET_DEVICE_URL, config)\n    }\n\n    playTrack = (id: string, queue_id?: string) => {\n        const config = {\n            method: 'PUT',\n            body: JSON.stringify({\n                uris: [`spotify:track:${id}`],\n            }),\n        }\n\n        this.abortController.abort()\n        this.abortController = new AbortController()\n\n        this.request(SPOTIFY_PLAYER_PLAY_URL, config).then(() => {\n            setTimeout(() => this.getPlayerState(this.pollingCallback), 500)\n        })\n        if (queue_id) this.api.doRemoveTrackFromQueue(queue_id)\n    }\n\n    playSimilarTrack = () => {\n        const id = localStorage.getItem(LAST_PLAYED_TRACK)\n        const config = {\n            method: 'GET',\n        }\n        const url = `${SPOTIFY_PLAYER_RECOMMENDATION_URL}?seed_tracks=${id}&limit=1`\n        this.request(url, config).then(({ tracks }: { tracks: TrackType[] }) => {\n            if (tracks && tracks.length > 0) {\n                this.playTrack(tracks[0].id)\n                // this.pollingCalback(tracks[0].id)\n            }\n        })\n    }\n\n    changeTrack = (next: boolean = true) => {\n        const url = next ? SPOTIFY_PLAYER_NEXT_TRACK_URL : SPOTIFY_PLAYER_PREVIOUS_TRACK_URL\n        const config = {\n            method: 'POST',\n        }\n        this.request(url, config)\n    }\n\n    togglePlayback = (isPlaying: boolean) => {\n        const url = isPlaying ? SPOTIFY_PLAYER_PAUSE_URL : SPOTIFY_PLAYER_PLAY_URL\n        const config = {\n            method: 'PUT',\n        }\n        this.request(url, config)\n    }\n\n    seekInPlayingTrack = (ms: number) => {\n        const url = `${SPOTIFY_PLAYER_SEEK_URL}?position_ms=${ms}`\n        const config = { method: 'PUT' }\n        this.request(url, config)\n    }\n\n    refreshToken = (): Promise<void> => {\n        console.log('Token expired:', this.token)\n        return this.api.doRefreshUserToken(this.token).then(token => {\n            this.token = token\n        })\n    }\n\n    request = (url: string, config: object) => {\n        if (this.token && tokenHasExpired(this.token)) {\n            return this.refreshToken().then(() => this.request(url, config))\n        }\n        return fetch(url, {\n            headers: {\n                Authorization: `Bearer ${this.token.access_token}`,\n            },\n            ...config,\n            signal: this.abortController.signal,\n        })\n            .then(res => {\n                if (res.status === 400) console.error(res.json())\n                if (res.status !== 204) return res.json()\n                else return res\n            })\n            .catch(err => console.error('Spotify API responded with error:', err))\n    }\n}\n\nexport const useSpotify = (): {\n    playerState: SpotifyApi.CurrentPlaybackResponse\n    controller: SpotifyPlayer\n    fetching: boolean\n} => {\n    const [initialFetch, setInitialFetch] = useState(true)\n    const api = useAPI()\n    const spotify = useMemo(() => new SpotifyPlayer(api), [api])\n    const [playerState, setPlayerState] = useState<SpotifyApi.CurrentPlaybackResponse>(\n        {} as SpotifyApi.CurrentPlaybackResponse,\n    )\n    useEffect(() => {\n        spotify.pollPlayerState((state: SpotifyApi.CurrentPlaybackResponse) => {\n            if (initialFetch) setInitialFetch(false)\n            setPlayerState(state)\n            if (state.item) localStorage.setItem(LAST_PLAYED_TRACK, state.item.id)\n        })\n        return spotify.clearPolling\n    }, [])\n    return { playerState, controller: spotify, fetching: initialFetch }\n}\n","module.exports = __webpack_public_path__ + \"static/media/placeholder.a1286edb.png\";","import React from 'react'\nimport { PersonIcon } from './'\nimport { useHistory } from 'react-router-dom'\nimport './styles/Header.scss'\n\ninterface Props {\n    size: 'xs' | 's' | 'm' | 'l' | 'xl'\n    color: 'white' | 'green'\n    numSubscribers?: number\n    id?: string\n}\n\nexport const Header: React.FC<Props> = ({ size, color, numSubscribers, id }: Props) => {\n    const history = useHistory()\n    return (\n        <div className={'header ' + color + ' ' + size}>\n            <h3 className=\"header-name\" onClick={history.goBack}>\n                Queue\n            </h3>\n            {id && (\n                <h3 className=\"header-code\">\n                    Go to <b>q.edenheim.se</b> and use the code <b>{id}</b>{' '}\n                </h3>\n            )}\n            {numSubscribers && (\n                <div className=\"header-person-icon\">\n                    {numSubscribers} <PersonIcon />\n                </div>\n            )}\n        </div>\n    )\n}\n","import React from 'react'\nimport { Dots } from './'\nimport './styles/Button.scss'\n\ninterface Props {\n    onClick: () => void\n    type?: 'green' | 'white' | 'transparent'\n    value?: string\n    loading?: boolean\n    className?: string\n}\n\nexport const Button: React.FC<Props> = ({\n    onClick,\n    type = 'green',\n    value = '',\n    loading = false,\n    className = '',\n}: Props) => {\n    return (\n        <button onClick={onClick} className={'button button-' + type + ' ' + className}>\n            <div>{loading ? <Dots /> : value}</div>\n        </button>\n    )\n}\n","import React from 'react'\nimport { Header } from '../Common/'\nimport './styles/URLNotFound.scss'\n\ninterface Props {}\n\nexport const URLNotFound: React.FC<Props> = () => {\n    return (\n        <div className=\"404\">\n            <Header color=\"green\" size=\"s\" />\n            <h3>404</h3>\n        </div>\n    )\n}\n","import React from 'react'\nimport './styles/Spinner.scss'\n\nexport const Dots = () => (\n    <div className=\"lds-ellipsis\">\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n    </div>\n)\n","import React from 'react'\n\nexport const Close = () => (\n    <svg viewBox=\"0 0 512 512\" className=\"icon-fill\">\n        <path d=\"M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z\" />\n    </svg>\n)\n\nexport const Next = () => (\n    <svg viewBox=\"0 0 170 174\" className=\"icon-fill\">\n        <path d=\"M132.916 87L20 153.684L20 20.316L132.916 87Z\" />\n        <rect x=\"132.916\" y=\"20\" width=\"16.6257\" height=\"134\" />\n    </svg>\n)\n\nexport const Previous = () => (\n    <svg viewBox=\"0 0 170 174\" className=\"icon-fill\">\n        <path d=\"M36.6257 87L149.542 20.316L149.542 153.684L36.6257 87Z\" />\n        <rect x=\"36.6257\" y=\"154\" width=\"16.6257\" height=\"134\" transform=\"rotate(-180 36.6257 154)\" />\n    </svg>\n)\n\nexport const Shuffle = () => (\n    <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" className=\"icon-fill\">\n        <g>\n            <g>\n                <g>\n                    <path\n                        d=\"M21.333,149.327H64c18.773,0,37.227,4.928,53.333,14.272c3.371,1.963,7.061,2.88,10.688,2.88\n\t\t\t\tc7.36,0,14.528-3.819,18.475-10.624c5.931-10.197,2.432-23.253-7.744-29.163C116.117,113.594,90.283,106.66,64,106.66H21.333\n\t\t\t\tC9.536,106.66,0,116.218,0,127.994S9.536,149.327,21.333,149.327z\"\n                    />\n                    <path\n                        d=\"M320,149.327h42.667v64c0,8.192,4.715,15.68,12.075,19.221c2.965,1.408,6.123,2.112,9.259,2.112\n\t\t\t\tc4.757,0,9.472-1.6,13.333-4.672L504,144.655c5.056-4.053,8-10.176,8-16.661c0-6.485-2.944-12.608-8-16.661L397.333,25.999\n\t\t\t\tc-6.421-5.12-15.232-6.101-22.592-2.56s-12.075,11.029-12.075,19.221v64H320c-82.325,0-149.333,66.987-149.333,149.333\n\t\t\t\tc0,58.816-47.851,106.667-106.667,106.667H21.333C9.536,362.66,0,372.218,0,383.994s9.536,21.333,21.333,21.333H64\n\t\t\t\tc82.325,0,149.333-66.987,149.333-149.333C213.333,197.178,261.184,149.327,320,149.327z\"\n                    />\n                    <path\n                        d=\"M504,367.336l-106.667-85.333c-6.421-5.141-15.232-6.123-22.592-2.581c-7.36,3.563-12.075,11.029-12.075,19.243v64H320\n\t\t\t\tc-21.077,0-41.472-6.144-58.965-17.771c-9.856-6.485-23.061-3.861-29.568,5.973c-6.528,9.813-3.861,23.061,5.952,29.568\n\t\t\t\tc24.512,16.277,53.056,24.896,82.581,24.896h42.667v64c0,8.192,4.715,15.68,12.075,19.221c2.965,1.408,6.123,2.112,9.259,2.112\n\t\t\t\tc4.757,0,9.472-1.6,13.333-4.672L504,400.659c5.056-4.053,8-10.197,8-16.661C512,377.512,509.056,371.368,504,367.336z\"\n                    />\n                </g>\n            </g>\n        </g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n    </svg>\n)\n\nexport const Connect = () => (\n    <svg viewBox=\"0 0 123 118\" className=\"icon-connect\">\n        <path\n            d=\"M50 10H14C11.7909 10 10 11.7909 10 14V80C10 82.2091 11.7909 84 14 84H50\"\n            strokeWidth=\"8\"\n            strokeLinejoin=\"round\"\n        />\n        <rect x=\"61\" y=\"10\" width=\"52\" height=\"98\" rx=\"6\" strokeWidth=\"8\" />\n        <path d=\"M35 108H50\" strokeWidth=\"8\" />\n        <circle cx=\"87\" cy=\"77\" r=\"14\" strokeWidth=\"8\" />\n        <circle cx=\"87\" cy=\"35\" r=\"5\" className=\"icon-fill\" />\n    </svg>\n)\n\nexport const Repeat = () => (\n    <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 511.991 511.991\" className=\"icon-fill\">\n        <g>\n            <g>\n                <g>\n                    <path\n                        d=\"M465.45,279.263c-12.87,0-23.273,10.426-23.273,23.273c0,38.493-31.325,69.818-69.818,69.818H186.177v-69.818\n\t\t\t\tc0-8.937-5.143-17.105-13.172-20.969c-8.122-3.863-17.641-2.793-24.646,2.793L31.995,377.451\n\t\t\t\tc-5.516,4.422-8.727,11.101-8.727,18.176c0,7.075,3.212,13.754,8.727,18.176l116.364,93.091\n\t\t\t\tc4.212,3.351,9.356,5.097,14.545,5.097c3.421,0,6.889-0.768,10.1-2.304c8.029-3.863,13.172-12.032,13.172-20.969V418.9h186.182\n\t\t\t\tc64.163,0,116.364-52.201,116.364-116.364C488.723,289.689,478.32,279.263,465.45,279.263z\"\n                    />\n                    <path\n                        d=\"M46.541,232.718c12.87,0,23.273-10.426,23.273-23.273c0-38.493,31.325-69.818,69.818-69.818h186.182v69.818\n\t\t\t\tc0,8.937,5.143,17.105,13.172,20.969c3.235,1.536,6.679,2.304,10.1,2.304c5.19,0,10.333-1.745,14.545-5.097l116.364-93.091\n\t\t\t\tc5.516-4.422,8.727-11.101,8.727-18.176s-3.212-13.754-8.727-18.176L363.632,5.087c-6.982-5.585-16.617-6.656-24.646-2.793\n\t\t\t\ts-13.172,12.032-13.172,20.969v69.818H139.632c-64.163,0-116.364,52.201-116.364,116.364\n\t\t\t\tC23.268,222.292,33.671,232.718,46.541,232.718z\"\n                    />\n                </g>\n            </g>\n        </g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n    </svg>\n)\n\nexport const Speaker = () => (\n    <svg viewBox=\"0 0 76 120\">\n        <rect x=\"12\" y=\"11\" width=\"52\" height=\"98\" rx=\"4\" strokeWidth=\"6\" />\n        <circle cx=\"38\" cy=\"78\" r=\"14\" strokeWidth=\"6\" />\n        <circle cx=\"38\" cy=\"36\" r=\"5\" className=\"icon-fill\" />\n    </svg>\n)\n\nexport const Phone = () => (\n    <svg viewBox=\"0 0 76 120\">\n        <rect x=\"12\" y=\"11\" width=\"52\" height=\"98\" rx=\"4\" strokeWidth=\"6\" />\n        <circle cx=\"38\" cy=\"96\" r=\"5\" className=\"icon-fill\" />\n    </svg>\n)\n\nexport const Computer = () => (\n    <svg viewBox=\"0 0 228 180\">\n        <rect x=\"35\" y=\"21\" width=\"157\" height=\"113\" rx=\"4\" strokeWidth=\"6\" />\n        <path d=\"M15 158H213\" strokeWidth=\"6\" />\n    </svg>\n)\n\nexport const Play = () => (\n    <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 320.001 320.001\" className=\"icon-fill\">\n        <path\n            d=\"M295.84,146.049l-256-144c-4.96-2.784-11.008-2.72-15.904,0.128C19.008,5.057,16,10.305,16,16.001v288\n\tc0,5.696,3.008,10.944,7.936,13.824c2.496,1.44,5.28,2.176,8.064,2.176c2.688,0,5.408-0.672,7.84-2.048l256-144\n\tc5.024-2.848,8.16-8.16,8.16-13.952S300.864,148.897,295.84,146.049z\"\n        />\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n    </svg>\n)\n\nexport const Pause = () => (\n    <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 47.607 47.607\" className=\"icon-fill\">\n        <g>\n            <path\n                d=\"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0\n\t\tl0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z\"\n            />\n            <path\n                d=\"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631\n\t\tC29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z\"\n            />\n        </g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n    </svg>\n)\n\nexport const PersonIcon = () => {\n    return (\n        <svg enableBackground=\"new 0 0 512 512\" viewBox=\"0 0 512 512\">\n            <g>\n                <path\n                    d=\"M348.574,145.901c0,53.522-43.377,96.914-96.901,96.914c-53.523,0-96.914-43.392-96.914-96.914    c0-53.51,43.391-96.901,96.914-96.901C305.197,49,348.574,92.391,348.574,145.901z\"\n                    fill=\"none\"\n                    stroke=\"#fff\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeMiterlimit=\"10\"\n                    strokeWidth=\"20\"\n                />\n                <path\n                    d=\"M275.38,274.46c95.561,9.706,170.154,90.401,170.154,188.54\"\n                    fill=\"none\"\n                    stroke=\"#fff\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeMiterlimit=\"10\"\n                    strokeWidth=\"20\"\n                />\n                <path\n                    d=\"M66.466,463c0-96.358,71.925-175.934,165.027-187.961\"\n                    fill=\"none\"\n                    stroke=\"#fff\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeMiterlimit=\"10\"\n                    strokeWidth=\"20\"\n                />\n            </g>\n        </svg>\n    )\n}\n\nexport const Heart = () => (\n    <svg viewBox=\"0 0 512 512\">\n        <path d=\"M340.8,83C307,83,276,98.8,256,124.8c-20-26-51-41.8-84.8-41.8C112.1,83,64,131.3,64,190.7c0,27.9,10.6,54.4,29.9,74.6  L245.1,418l10.9,11l10.9-11l148.3-149.8c21-20.3,32.8-47.9,32.8-77.5C448,131.3,399.9,83,340.8,83L340.8,83z\" />\n    </svg>\n)\n\nexport const HeartOutline = () => (\n    <svg viewBox=\"0 0 512 512\">\n        <path d=\"M340.8,98.4c50.7,0,91.9,41.3,91.9,92.3c0,26.2-10.9,49.8-28.3,66.6L256,407.1L105,254.6c-15.8-16.6-25.6-39.1-25.6-63.9  c0-51,41.1-92.3,91.9-92.3c38.2,0,70.9,23.4,84.8,56.8C269.8,121.9,302.6,98.4,340.8,98.4 M340.8,83C307,83,276,98.8,256,124.8  c-20-26-51-41.8-84.8-41.8C112.1,83,64,131.3,64,190.7c0,27.9,10.6,54.4,29.9,74.6L245.1,418l10.9,11l10.9-11l148.3-149.8  c21-20.3,32.8-47.9,32.8-77.5C448,131.3,399.9,83,340.8,83L340.8,83z\" />\n    </svg>\n)\n","import React, { useState, useEffect } from 'react'\nimport { Join, Host } from './'\nimport { ROUTES, useAPI } from '../../utils'\nimport { RouteComponentProps } from 'react-router'\nimport './styles/Start.scss'\n\nconst ERROR_SESSION = 'The session could not be found'\nconst ERROR_AUTH = 'User could not be authenticated'\n\ninterface MatchParams {\n    id: string\n}\n\ninterface Props extends RouteComponentProps<MatchParams> {\n    onSelect?: (s: string) => void\n}\n\nexport const Start: React.FC<Props> = ({ onSelect, history }: Props) => {\n    const api = useAPI()\n\n    const [error, setError] = useState('')\n    const [loading, setLoading] = useState(false)\n\n    useEffect(() => {\n        // Wake up idle Heroku dyno\n        api.ping()\n    }, [api])\n\n    const handleHostRoom = async (): Promise<any> => {\n        console.log('Authorizing...')\n        api.doAuthorizeUser()\n            .then(async () => {\n                console.log('Authorized!')\n                const id = await api.doSetupRoom()\n                history.push(ROUTES.HOST.replace(':id', id))\n            })\n            .catch(err => {\n                setError(ERROR_AUTH)\n            })\n    }\n\n    const handleJoinRoom = async (id: string): Promise<any> => {\n        setLoading(true)\n        if (await api.doValidateRoomID(id)) {\n            history.push(ROUTES.ROOM.replace(':id', id))\n        } else {\n            setLoading(false)\n            setError(ERROR_SESSION)\n        }\n    }\n\n    return (\n        <div className=\"start\">\n            <h3 className=\"xl green\">Queue</h3>\n            <div className=\"start-buttons\">\n                <Host onSelect={handleHostRoom} />\n                <Join onSelect={handleJoinRoom} loading={loading} />\n            </div>\n            {error && <div className=\"start-error\">{error}</div>}\n        </div>\n    )\n}\n","import React, { useState } from 'react'\nimport { Button } from '../Common/'\n\ntype Props = {\n    onSelect: () => void\n}\n\nexport const Host: React.FC<Props> = ({ onSelect }: Props) => {\n    const [isLoading, setLoading] = useState(false)\n\n    const handleClick = () => {\n        setLoading(true)\n        onSelect()\n    }\n\n    return <Button onClick={handleClick} value=\"Host\" type=\"transparent\" loading={isLoading} />\n}\n","import React, { useState, useRef, useEffect, useCallback } from 'react'\nimport { Button } from '../Common/'\nimport { TextInput } from './'\n\ntype Props = {\n    onSelect: (s: string) => void\n    loading: boolean\n}\n\nexport const Join: React.FC<Props> = ({ onSelect, loading }: Props) => {\n    const [input, setInput] = useState<string>('')\n    const [inputVisible, setInputVisible] = useState<boolean>(false)\n    const joinRef = useRef<HTMLDivElement>(document.createElement('div'))\n\n    const handleSubmit = useCallback((): void => {\n        if (inputVisible && input.length > 0) {\n            onSelect(input)\n        } else {\n            setInputVisible(true)\n        }\n    }, [inputVisible, input, onSelect])\n\n    const handleClickOutside = useCallback(\n        (e: MouseEvent): void => {\n            if (!joinRef.current.contains(e.target as Node) && inputVisible) {\n                setInputVisible(false)\n            }\n        },\n        [inputVisible],\n    )\n\n    const handleEnterPressed = useCallback(\n        (e: KeyboardEvent): void => {\n            if (e.key === 'Enter') {\n                handleSubmit()\n            }\n        },\n        [handleSubmit],\n    )\n\n    useEffect(() => {\n        document.addEventListener('click', handleClickOutside)\n        document.addEventListener('keydown', handleEnterPressed)\n        return () => {\n            document.removeEventListener('click', handleClickOutside)\n            document.removeEventListener('keydown', handleEnterPressed)\n        }\n    }, [handleEnterPressed, handleClickOutside])\n\n    return (\n        <div ref={joinRef} className={'join-button' + (inputVisible ? ' show' : '')}>\n            <Button\n                className={loading ? 'loading' : ''}\n                onClick={handleSubmit}\n                value={inputVisible ? '\\uFF0B' : 'Join'}\n                type=\"green\"\n            />\n            <TextInput onChange={setInput} placeholder=\"Room code\" value={input} visible={inputVisible} />\n        </div>\n    )\n}\n","import React from 'react'\nimport './styles/TextInput.scss'\n\ninterface Props {\n    onChange: (s: string) => void\n    value: string | undefined,\n    placeholder?: string\n    visible?: boolean\n}\n\nexport const TextInput: React.FC<Props> = ({ onChange, value, visible=true, placeholder='' }: Props) => {\n    return (\n        <input\n            className={visible ? 'text-input visible' : 'text-input'}\n            type=\"text\"\n            value={value}\n            onChange={(e: React.ChangeEvent<HTMLInputElement>): void => {\n                onChange(e.target.value)\n            }}\n            placeholder={placeholder}\n        />\n    )\n}\n","import React, { useEffect } from 'react'\nimport { RouteComponentProps } from 'react-router-dom'\nimport { useAPI } from '../../utils'\n\nexport interface RedirectProps extends RouteComponentProps {}\n\nexport const Redirect: React.FC<RedirectProps> = props => {\n    const api = useAPI()\n\n    useEffect(() => {\n        const query = new URLSearchParams(props.location.search)\n        const code = query.get('code')\n        api.doFetchUserToken(code).then(() => {\n            window.opener.tokenCallback()\n            window.close()\n        })\n    }, [api, props.location])\n    return <div></div>\n}\n","import React, { useEffect, useCallback, useRef, useState } from 'react'\nimport { useDebouncedInput } from '../../utils'\nimport './styles/SearchInput.scss'\n\ninterface SearchProps {\n    onCancel: () => void\n    onSearchUpdate: (s: string) => void\n    searching: boolean\n}\n\nexport const SearchInput: React.FC<SearchProps> = ({ onCancel, onSearchUpdate, searching }) => {\n    const inputRef = useRef<HTMLInputElement>(document.createElement('input'))\n    const { input, setInput, handleInputChange } = useDebouncedInput(onSearchUpdate, onCancel)\n    const [hasFocus, setFocus] = useState(false)\n\n    const handleCancel = useCallback(() => {\n        inputRef.current.blur()\n        setInput('')\n        onCancel()\n    }, [onCancel, setInput])\n\n    const handleKeyPressed = useCallback(\n        (e: KeyboardEvent) => {\n            if (e.key === 'Escape') {\n                handleCancel()\n            }\n        },\n        [handleCancel],\n    )\n\n    useEffect(() => {\n        const current = inputRef.current\n        current.addEventListener('keydown', handleKeyPressed)\n\n        return () => {\n            current.removeEventListener('keydown', handleKeyPressed)\n        }\n    }, [handleKeyPressed])\n\n    useEffect(() => {\n        if (!searching && input.length > 0) {\n            setInput('')\n        }\n    })\n\n    return (\n        <div className=\"search-input\">\n            <input\n                ref={inputRef}\n                tabIndex={1}\n                onFocus={() => setFocus(true)}\n                onBlur={() => setFocus(false)}\n                onChange={handleInputChange}\n                value={input}\n                type=\"text\"\n                placeholder=\"Sk\"\n            />\n            {(searching || hasFocus) && <button onClick={handleCancel}>&#x2573;</button>}\n        </div>\n    )\n}\n","import React, { useState, useEffect } from 'react'\nimport { TrackType } from '../../utils'\nimport { Heart, HeartOutline } from '../Common'\nimport './styles/SearchResults.scss'\n\nfunction getArtwork(album: string) {\n    if (album.length > 0) {\n        return album\n    } else {\n        return require('../../assets/img/placeholder.png')\n    }\n}\n\ninterface SearchResultProps {\n    tracks: TrackType[]\n    onAddTrack: (track: TrackType) => void\n    onRemoveTrack: (id: string) => void\n}\n\nexport const SearchResults: React.FC<SearchResultProps> = ({\n    tracks,\n    onAddTrack,\n    onRemoveTrack,\n}: SearchResultProps) => {\n    const [queuedTracks, setQueuedTracks] = useState(tracks.map(t => t.id))\n\n    useEffect(() => {\n        setQueuedTracks(Array(tracks.length).fill(false))\n    }, [tracks])\n\n    const handleAddTrack = (index: number) => {\n        if (queuedTracks[index]) {\n            onRemoveTrack(tracks[index].queue_id)\n        } else {\n            onAddTrack(tracks[index])\n        }\n        const copy = [...queuedTracks]\n        copy[index] = !copy[index]\n        setQueuedTracks(copy)\n    }\n\n    return (\n        <div className=\"list-container\">\n            <ul className=\"track-list search-results\">\n                {tracks.map((track, index) => (\n                    <li key={track.queue_id}>\n                        <img src={getArtwork(track.album_s)} alt=\"\" />\n                        <div className=\"track-names\">\n                            <div>\n                                <h3>{track.title}</h3>\n                            </div>\n                            <div>{track.artist}</div>\n                        </div>\n                        <button onClick={() => handleAddTrack(index)}>\n                            <div>{queuedTracks[index] ? <Heart /> : <HeartOutline />}</div>\n                        </button>\n                    </li>\n                ))}\n            </ul>\n        </div>\n    )\n}\n","import React from 'react'\nimport { PulseLoader as Spinner } from 'react-spinners'\nimport { SearchInput, SearchResults } from './'\nimport { useSearch } from '../../utils'\nimport './styles/Search.scss'\n\ninterface Props {\n    queue: any\n}\n\nexport const Search: React.FC<Props> = ({ children, queue }) => {\n    const { searching, searchUpdate, cancelSearch, search } = useSearch()\n    return (\n        <div className=\"search\">\n            <SearchInput onSearchUpdate={searchUpdate} onCancel={cancelSearch} searching={searching} />\n            {searching ? (\n                search.loading ? (\n                    <Spinner css={'margin-top: 10vh;'} size={10} color={'white'} />\n                ) : search.result && search.result.length > 0 ? (\n                    <SearchResults\n                        onAddTrack={queue.addToQueue}\n                        onRemoveTrack={queue.removeFromQueue}\n                        tracks={search.result}\n                    />\n                ) : (\n                    <p>No results</p>\n                )\n            ) : (\n                children\n            )}\n        </div>\n    )\n}\n","import React from 'react'\nimport { Header } from '../Common/'\nimport { RouteComponentProps } from 'react-router'\nimport { useWebSocket, useSpotify } from '../../utils'\nimport { Search } from '../Search'\nimport './styles/Host.scss'\nimport { Player, TrackList } from './'\n\ninterface MatchParams {\n    id: string\n}\n\ninterface Props extends RouteComponentProps<MatchParams> {}\n\nexport const Host: React.FC<Props> = (props: Props) => {\n    const { subscribers, queue } = useWebSocket(props.match.params.id)\n    const { playerState, controller, fetching } = useSpotify()\n\n    return (\n        <div className=\"host\">\n            <Header color=\"green\" size=\"s\" numSubscribers={subscribers} id={props.match.params.id} />\n            <div className=\"host-content\">\n                <Player tracks={queue.tracks} playerState={playerState} controller={controller} fetching={fetching} />\n                <Search queue={queue}>\n                    <TrackList tracks={queue.tracks} onDelete={queue.removeFromQueue} onPlay={controller.playTrack} />\n                </Search>\n            </div>\n        </div>\n    )\n}\n","import React from 'react'\nimport { TrackType } from '../../utils'\nimport { Play, Close } from '../Common'\nimport './styles/TrackList.scss'\n\ninterface TrackListProps {\n    tracks: TrackType[]\n    onDelete: (id: string) => void\n    onPlay: (id: string, queue_id: string) => void\n}\n\nexport const TrackList: React.FC<TrackListProps> = ({ tracks, onDelete, onPlay }: TrackListProps) => {\n    return (\n        <ul className=\"host-track-list\">\n            <li>\n                <div>TITLE</div>\n                <div>ARTIST</div>\n                <div>VOTES</div>\n            </li>\n            {tracks.length > 0 ? (\n                tracks.map((track, index) => (\n                    <li key={track.queue_id} className=\"track-list-item\">\n                        <div>{track.title}</div>\n                        <div>{track.artist}</div>\n                        <div>{track.votes}</div>\n                        <button onClick={() => onPlay(track.id, track.queue_id)}>\n                            <Play />\n                        </button>\n                        <button onClick={() => onDelete(track.queue_id)}>\n                            <Close />\n                        </button>\n                    </li>\n                ))\n            ) : (\n                <li>\n                    <h3>The Queue is empty</h3>\n                </li>\n            )}\n        </ul>\n    )\n}\n","import React, { useRef, useEffect } from 'react'\nimport VanillaTilt from 'vanilla-tilt'\nimport './styles/Image.scss'\n\nconst OPTIONS = {\n    perspective: 2000,\n    speed: 500,\n    max: 5,\n}\n\nexport interface Props {\n    src: string\n}\n\nexport const Image: React.FC<Props> = ({ src }: Props) => {\n    const tilt = useRef<HTMLDivElement>(document.createElement('div'))\n\n    useEffect(() => {\n        VanillaTilt.init(tilt.current, OPTIONS)\n    })\n\n    return (\n        <div ref={tilt} className=\"album-tilt\">\n            <img src={src} alt=\"Album artwork\" />\n        </div>\n    )\n}\n","import React, { useEffect, useState } from 'react'\n\ninterface OverlayProps {\n    fetching: boolean\n}\n\nexport const Overlay: React.FC<OverlayProps> = ({ fetching }) => {\n    const [showOverlay, setShowOverlay] = useState(fetching)\n\n    useEffect(() => {\n        setTimeout(() => setShowOverlay(false), 1000)\n    }, [fetching])\n\n    return showOverlay ? <div className={'player-loading-overlay' + (fetching ? '' : ' disabled')}></div> : null\n}\n","import React from 'react'\nimport { Next, Play, Previous, Pause, Shuffle, Connect } from '../Common/Icons'\ninterface ControllButtonProps {\n    type: 'shuffle' | 'prev' | 'play' | 'pause' | 'next' | 'connect'\n    onClick?: () => void\n}\n\nexport const ControllButton: React.FC<ControllButtonProps> = ({ type, onClick }: ControllButtonProps) => {\n    const isCircled = type === 'play' || type === 'pause'\n    const renderIcon = () => {\n        switch (type) {\n            case 'next':\n                return <Next />\n            case 'play':\n                return <Play />\n            case 'prev':\n                return <Previous />\n            case 'pause':\n                return <Pause />\n            case 'shuffle':\n                return <Shuffle />\n            case 'connect':\n                return <Connect />\n        }\n    }\n    return (\n        <button onClick={onClick} className={'player-controll-button ' + type + (isCircled ? ' circle' : '')}>\n            {renderIcon()}\n        </button>\n    )\n}\n","import React from 'react'\nimport { PulseLoader as Spinner } from 'react-spinners'\nimport { Computer, Speaker, Phone } from '../Common/Icons'\ninterface PopUpProps {\n    devices: SpotifyApi.UserDevice[]\n    onClick: (id: string) => void\n}\n\nexport const PopUp: React.FC<PopUpProps> = ({ devices, onClick }) => {\n    const getIcon = (type: string) => {\n        switch (type) {\n            case 'Computer':\n                return <Computer />\n            case 'Speaker':\n                return <Speaker />\n            case 'Smartphone':\n                return <Phone />\n            default:\n                return <Speaker />\n        }\n    }\n\n    return (\n        <div>\n            <ul>\n                {devices.length > 0 ? (\n                    devices.map((device, index) => (\n                        <li key={device.id}>\n                            <button\n                                className={\n                                    device.is_restricted ? 'device-restricted' : device.is_active ? 'device-active' : ''\n                                }\n                                disabled={device.is_restricted}\n                                onClick={() => onClick(device.id)}\n                            >\n                                {getIcon(device.type)}\n                                <p>{device.name}</p>\n                            </button>\n                        </li>\n                    ))\n                ) : (\n                    <li className=\"loading\">\n                        <Spinner size={10} color={'white'} />\n                    </li>\n                )}\n            </ul>\n        </div>\n    )\n}\n","import React, { useEffect, useState } from 'react'\nimport { SpotifyPlayer } from '../../utils/'\nimport { PopUp } from './PopUpMenu'\nimport { ControllButton } from './ControllButton'\n\ninterface ConnectButtonProps {\n    controller: SpotifyPlayer\n}\n\nexport const ConnectButton: React.FC<ConnectButtonProps> = ({ controller }) => {\n    const [isVisible, setIsVisible] = useState(false)\n    const [devices, setDevices] = useState([])\n\n    const handleTogglePopUp = () => {\n        if (!isVisible) controller.getDevices().then(setDevices)\n        setIsVisible(!isVisible)\n    }\n\n    const handleSelectDevice = (id: string) => {\n        controller\n            .setDevice(id)\n            .then(controller.getDevices)\n            .then(setDevices)\n    }\n\n    useEffect(() => {\n        let mounted = true\n        controller.getDevices().then(devices => {\n            if (mounted) setDevices(devices)\n        })\n        return () => (mounted = false)\n    }, [controller.getDevices, controller])\n\n    return (\n        <div className=\"player-controll-connect\">\n            {isVisible && <PopUp devices={devices} onClick={handleSelectDevice} />}\n            <ControllButton onClick={handleTogglePopUp} type=\"connect\" />\n        </div>\n    )\n}\n","import React, { useEffect, useState } from 'react'\nimport { useInterval } from '../../utils/hooks'\nimport { millisToMinutesAndSeconds } from '../../utils/helpers'\n\ninterface ProgressBarProps {\n    current: number\n    length: number\n    isPlaying: boolean\n    onSeek: (ms: number) => void\n    onEnd: () => void\n}\n\nconst OFFSET = 1000\n\nexport const ProgressBar: React.FC<ProgressBarProps> = ({\n    current,\n    length,\n    isPlaying,\n    onSeek,\n    onEnd,\n}: ProgressBarProps) => {\n    const [progress, setProgress] = useState(current)\n\n    const styles = {\n        // transform: `scaleX(${progress / length})`,\n        width: `${(100 * progress) / length}%`,\n    }\n\n    useInterval(() => {\n        if (isPlaying) {\n            const next = progress + 1000 + OFFSET\n            if (next < length) setProgress(next - OFFSET)\n            else {\n                setProgress(0)\n                onEnd()\n            }\n        }\n    }, 1000)\n\n    useEffect(() => {\n        if (progress > 0 && isPlaying) {\n            setProgress(current)\n        }\n    }, [current, length])\n\n    const handleSeekTrack = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n        const progressBar = e.currentTarget\n        const progressBarWidth = progressBar.offsetWidth\n        const progressBarClickPosition = e.clientX - progressBar.getBoundingClientRect().left\n        const progressBarProgressClicked = progressBarClickPosition / progressBarWidth\n        const progressInMs = Math.round(progressBarProgressClicked * length)\n        onSeek(progressInMs)\n        setProgress(progressInMs)\n    }\n\n    return (\n        <div className=\"progress-bar-container\">\n            <div>{millisToMinutesAndSeconds(progress)}</div>\n            <div className=\"progress-bar\" onClick={handleSeekTrack}>\n                <div style={styles}></div>\n            </div>\n            <div>{millisToMinutesAndSeconds(length)}</div>\n        </div>\n    )\n}\n","import React, { useEffect, useState } from 'react'\nimport { SpotifyPlayer, TrackType } from '../../utils/'\nimport { ControllButton } from './ControllButton'\nimport { ConnectButton } from './ConnectButton'\nimport { ProgressBar } from './ProgressBar'\n\ninterface DisabledControllerProps {\n    controller: SpotifyPlayer\n}\n\nexport const DisabledController: React.FC<DisabledControllerProps> = ({ controller }) => {\n    return (\n        <div className=\"player-controller\">\n            <div className=\"player-controller-controlls\">\n                <ControllButton onClick={() => {}} type=\"shuffle\" />\n                <ControllButton onClick={() => {}} type=\"prev\" />\n                <ControllButton onClick={() => {}} type={'play'} />\n                <ControllButton onClick={() => {}} type=\"next\" />\n                <ConnectButton controller={controller} />\n            </div>\n            <ProgressBar isPlaying={false} length={0} current={0} onSeek={(ms: number) => {}} onEnd={() => {}} />\n        </div>\n    )\n}\n\ninterface ControllerProps {\n    state: SpotifyApi.CurrentPlaybackResponse\n    controller: SpotifyPlayer\n    tracks: TrackType[]\n}\n\nexport const Controller: React.FC<ControllerProps> = ({ state, controller, tracks }) => {\n    const [isPlaying, setIsPlaying] = useState(state.is_playing)\n\n    useEffect(() => {\n        setIsPlaying(state.is_playing)\n    }, [state.is_playing])\n\n    const handleTogglePlayback = () => {\n        controller.togglePlayback(isPlaying)\n        setIsPlaying(!isPlaying)\n    }\n\n    const handlePlayNextTrack = () => {\n        if (tracks.length > 0) {\n            controller.playTrack(tracks[0].id, tracks[0].queue_id)\n        } else {\n            controller.playSimilarTrack()\n        }\n    }\n\n    return (\n        <div className=\"player-controller\">\n            <div className=\"player-controller-controlls\">\n                <ControllButton onClick={() => console.log(controller)} type=\"shuffle\" />\n                <ControllButton onClick={() => controller.changeTrack(false)} type=\"prev\" />\n                <ControllButton onClick={handleTogglePlayback} type={isPlaying ? 'pause' : 'play'} />\n                <ControllButton onClick={handlePlayNextTrack} type=\"next\" />\n                <ConnectButton controller={controller} />\n            </div>\n            <ProgressBar\n                isPlaying={isPlaying}\n                length={state.item.duration_ms}\n                current={state.progress_ms}\n                onSeek={controller.seekInPlayingTrack}\n                onEnd={handlePlayNextTrack}\n            />\n        </div>\n    )\n}\n","import React from 'react'\nimport { TrackType, SpotifyPlayer } from '../../utils'\nimport { Image } from './Image'\nimport './styles/Player.scss'\nimport { Overlay } from './Overlay'\nimport { DisabledController, Controller } from './Controller'\n\nconst PLACEHOLDER_TRACK = {\n    src: require('../../assets/img/placeholder.png'),\n    artist: 'Artist',\n    track: 'Track',\n}\n\ninterface PlayerProps {\n    tracks: TrackType[]\n    playerState: SpotifyApi.CurrentPlaybackResponse\n    controller: SpotifyPlayer\n    fetching: boolean\n}\n\nexport const Player: React.FC<PlayerProps> = ({ tracks, playerState, controller, fetching }) => {\n    const playerIsActive = playerState && 'is_playing' in playerState && playerState.item\n    const track = playerState?.item\n\n    return (\n        <>\n            <Overlay fetching={fetching} />\n            <div className=\"player\">\n                {playerIsActive ? (\n                    <>\n                        <Image src={track.album.images[0].url} />\n                        <h3>{track.artists[0].name}</h3>\n                        <p>{track.name}</p>\n                        <Controller tracks={tracks} state={playerState} controller={controller} />\n                    </>\n                ) : (\n                    <>\n                        <Image src={PLACEHOLDER_TRACK.src} />\n                        <h3>{PLACEHOLDER_TRACK.artist}</h3>\n                        <p>{PLACEHOLDER_TRACK.track}</p>\n                        <DisabledController controller={controller} />\n                    </>\n                )}\n            </div>\n        </>\n    )\n}\n","import React from 'react'\nimport { Header } from '../Common/'\nimport { TrackList } from './'\nimport { Search } from '../Search'\nimport { RouteComponentProps } from 'react-router'\nimport { useWebSocket } from '../../utils'\nimport './styles/Spectator.scss'\n\ninterface MatchParams {\n    id: string\n}\n\ninterface Props extends RouteComponentProps<MatchParams> {}\n\nexport const Spectator: React.FC<Props> = React.memo(({ match }) => {\n    const { subscribers, queue } = useWebSocket(match.params.id)\n\n    return (\n        <div className=\"spectator\">\n            <Header color=\"green\" size=\"s\" numSubscribers={subscribers} />\n            <Search queue={queue}>\n                <TrackList onVote={queue.vote} votes={queue.votes} tracks={queue.tracks} />\n            </Search>\n        </div>\n    )\n})\n","import React from 'react'\nimport { TrackType } from '../../utils'\nimport { Heart, HeartOutline } from '../Common'\nimport './styles/TrackList.scss'\n\ninterface TrackListProps {\n    tracks: TrackType[]\n    votes: string[]\n    onVote: (id: string, voted: boolean) => void\n}\n\nexport const TrackList: React.FC<TrackListProps> = ({ tracks, votes, onVote }: TrackListProps) => {\n    return (\n        <div className=\"list-container\">\n            <ul className=\"track-list\">\n                {tracks.map((track, index) => {\n                    const hasVoted = votes.includes(track.queue_id)\n                    return (\n                        <li key={track.queue_id}>\n                            <img src={track.album_s} alt=\"\" />\n                            <div className=\"track-names\">\n                                <div>\n                                    <h3>{track.title}</h3>\n                                </div>\n                                <div>{track.artist}</div>\n                            </div>\n                            <div>\n                                <div>\n                                    {track.votes} vote{track.votes !== 1 && 's'}\n                                </div>\n                                <button onClick={() => onVote(track.queue_id, !hasVoted)}>\n                                    {hasVoted ? <Heart /> : <HeartOutline />}\n                                </button>\n                            </div>\n                        </li>\n                    )\n                })}\n            </ul>\n        </div>\n    )\n}\n","import React from 'react'\nimport { Header } from '../Common/'\nimport './styles/Login.scss'\n\ninterface Props {}\n\nexport const Login: React.FC<Props> = () => {\n    return (\n        <div className=\"login\">\n            <Header color=\"green\" size=\"s\" />\n            <h3>Login</h3>\n        </div>\n    )\n}\n","import React from 'react'\nimport { Start, Redirect, Spectator, Host, Login, URLNotFound } from './components/'\nimport * as ROUTES from './utils/routes'\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom'\nimport './styles/App.scss'\n\n/**\n * TODO:\n *  - Host/Spectator: Lazy-load additional search results\n *  - Host: Fullscreen mode\n *  - Host: Logout / Remove session\n *  - Host: Sync with lyrics from external API\n *  - Host: Pause/Play with keyboard input\n \n *\n * FIX:\n *  - Host: Close device list when clicking outside\n */\n\nconst App: React.FC = () => {\n    return (\n        <div className=\"App\">\n            <Router basename={process.env.PUBLIC_URL}>\n                <Switch>\n                    <Route path={ROUTES.START} exact component={Start} />\n                    <Route path={ROUTES.LOGIN} exact component={Login} />\n                    <Route path={ROUTES.ROOM} exact component={Spectator} />\n                    <Route path={ROUTES.HOST} exact component={Host} />\n                    <Route path={ROUTES.REDIRECT} exact component={Redirect} />\n                    <Route>\n                        <URLNotFound />\n                    </Route>\n                </Switch>\n            </Router>\n        </div>\n    )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './styles/index.css'\nimport App from './App'\nimport { AuthContext, Auth, APIContext, API } from './utils/'\n\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(\n    <APIContext.Provider value={new API()}>\n        <AuthContext.Provider value={new Auth()}>\n            <App />\n        </AuthContext.Provider>\n    </APIContext.Provider>,\n    document.getElementById('root'),\n)\nserviceWorker.unregister()\n"],"sourceRoot":""}