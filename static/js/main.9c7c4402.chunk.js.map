{"version":3,"sources":["utils/index.ts","utils/constants.ts","utils/routes.ts","utils/helpers.ts","utils/Hooks.ts","utils/Auth.ts","utils/Api.ts","assets/img/placeholder.png","components/Common/Header.tsx","components/Common/Button.tsx","components/Common/URLNotFound.tsx","components/Common/Spinner.tsx","components/Common/Icons.tsx","components/Start/Start.tsx","components/Start/Host.tsx","components/Start/Join.tsx","components/Start/TextInput.tsx","components/Start/Redirect.tsx","components/Search/SearchInput.tsx","components/Search/SearchResults.tsx","components/Search/Search.tsx","components/Host/Host.tsx","components/Host/TrackList.tsx","components/Host/Player.tsx","components/Host/Image.tsx","utils/Spotify.ts","components/Spectator/Spectator.tsx","components/Spectator/TrackList.tsx","components/Login/Login.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["BASE_URL","process","SOCKET_URL","HOST_URL","SEARCH_URL","VALIDATE_ROOM_URL","AUTHORIZE_URL","REQUEST_TOKEN_URL","REFRESH_TOKEN_URL","GET_QUEUE_URL","ADD_TRACK_TO_QUEUE_URL","REMOVE_TRACK_FROM_QUEUE_URL","PING_URL","SPOTIFY_PLAYER_RECOMMENDATION_URL","SPOIFY_BASE_URL","SPOTIFY_PLAYER_BASE_URL","SPOTIFY_PLAYER_PLAY_URL","SPOTIFY_PLAYER_PAUSE_URL","SPOTIFY_PLAYER_NEXT_TRACK_URL","SPOTIFY_PLAYER_PREVIOUS_TRACK_URL","SPOTIFY_PLAYER_SEEK_URL","SPOTIFY_PLAYER_GET_DEVICES_URL","SPOTIFY_PLAYER_SET_DEVICE_URL","SPOTIFY_USER_TOKEN","VOTED_TRACKS","LAST_PLAYED_TRACK","START","ROOM","LOGIN","HOST","REDIRECT","validateRoomID","s","length","includes","tokenHasExpired","token","expires_on","Date","now","Fetch","url","method","body","signal","fetch","credentials","headers","JSON","stringify","undefined","then","gatherResponse","catch","console","error","response","a","async","status","Error","json","setVote","id","vote","votes","getVotes","push","filter","v","localStorage","setItem","getItem","parse","setupLocalStorage","millisToMinutesAndSeconds","millis","minutes","Math","floor","seconds","useDebouncedInput","onUpdate","onCancel","useState","input","setInput","debouncedInput","value","delay","debouncedValue","setDebouncedValue","useEffect","handler","setTimeout","clearTimeout","useDebounce","handleInputChange","e","target","useSearch","searchInput","setSearchInput","searching","setSearching","api","useAPI","search","useAsyncAbortable","abortSignal","text","doSearchTrack","handleCancelSearch","reset","handleEscapePressed","key","document","addEventListener","removeEventListener","cancelSearch","searchUpdate","useWebSocket","queue","useQueue","history","useHistory","subscribers","setSubscribers","doValidateRoomID","isValid","doGetQueue","setTracks","doLeaveRoom","callbacks","n","addTrackToQueue","addedToQueue","removeTrackFromQueue","removedFromQueue","voted","doJoinRoom","tracks","setVotes","setVoteInStorage","useVotes","sort","b","addToQueue","track","doAddTrackToQueue","queue_id","removeFromQueue","doRemoveTrackFromQueue","t","log","doVoteForTrack","copy","index","findIndex","useInterval","callback","savedCallback","useRef","current","setInterval","clearInterval","Auth","auth","roomId","doLogin","doSignOut","this","AuthContext","React","createContext","API","ws","host","window","roomID","inSession","connect","WebSocket","onopen","onclose","par","check","onerror","err","close","readyState","CLOSED","ping","doSendMessage","type","payload","message","Message","interval","OPEN","send","cb","onmessage","data","doAuthorizeUser","Promise","resolve","doRefreshUserToken","left","screen","width","top","height","popup","open","location","href","res","replace","alert","doFetchUserToken","code","expires_in","refresh_token","newToken","doSetupRoom","query","room","APIContext","useContext","module","exports","Header","size","color","numSubscribers","className","onClick","goBack","Button","loading","URLNotFound","Dots","Close","viewBox","d","Next","x","y","Previous","transform","Shuffle","Connect","strokeWidth","strokeLinejoin","rx","cx","cy","r","Speaker","Phone","Computer","Play","Pause","PersonIcon","enableBackground","fill","stroke","strokeLinecap","strokeMiterlimit","Heart","HeartOutline","Start","onSelect","setError","setLoading","ROUTES","Host","isLoading","Join","inputVisible","setInputVisible","joinRef","createElement","handleSubmit","useCallback","handleClickOutside","contains","handleEnterPressed","ref","onChange","placeholder","visible","TextInput","Redirect","props","URLSearchParams","get","opener","tokenCallback","SearchInput","onSearchUpdate","inputRef","hasFocus","setFocus","handleCancel","blur","handleKeyPressed","tabIndex","onFocus","onBlur","SearchResults","onAddTrack","onRemoveTrack","map","queuedTracks","setQueuedTracks","Array","src","getArtwork","album_s","alt","title","artist","handleAddTrack","album","require","Search","children","css","result","match","params","useSpotify","playerState","controller","fetching","onDelete","onPlay","playTrack","TrackList","PLACEHOLDER_TRACK","Player","item","images","artists","name","state","renderPlayer","Overlay","showOverlay","setShowOverlay","DisabledController","isPlaying","onSeek","ms","onEnd","Controller","is_playing","setIsPlaying","handlePlayNextTrack","playSimilarTrack","changeTrack","togglePlayback","duration_ms","progress_ms","seekInPlayingTrack","PopUp","devices","device","is_restricted","is_active","disabled","getIcon","ConnectButton","isVisible","setIsVisible","setDevices","mounted","getDevices","setDevice","ControllButton","isCircled","renderIcon","ProgressBar","progress","setProgress","styles","next","progressBar","currentTarget","progressBarWidth","offsetWidth","progressBarProgressClicked","clientX","getBoundingClientRect","progressInMs","round","style","OPTIONS","perspective","speed","max","Image","tilt","VanillaTilt","init","SpotifyPlayer","playerInterval","pollingCallback","abortController","pollPlayerState","getPlayerState","clearPolling","request","config","device_ids","uris","abort","AbortController","refreshToken","Authorization","access_token","initialFetch","setInitialFetch","spotify","setPlayerState","Spectator","memo","onVote","hasVoted","Login","App","basename","path","exact","component","Boolean","hostname","ReactDOM","render","Provider","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.9c7c4402.chunk.js","sourcesContent":["import * as ROUTES from './routes'\nexport { ROUTES }\nexport { useAuth, Auth, AuthContext } from './Auth'\nexport { useAPI, APIContext, API } from './Api'\nexport { validateRoomID, Fetch, tokenHasExpired, getVotes, setVote, millisToMinutesAndSeconds } from './helpers'\nexport { useDebounce, useDebouncedInput, useSearch, useWebSocket, useQueue, useInterval } from './Hooks'\n\nexport {\n    AUTHORIZE_URL,\n    GET_QUEUE_URL,\n    HOST_URL,\n    VALIDATE_ROOM_URL,\n    SOCKET_URL,\n    SEARCH_URL,\n    REFRESH_TOKEN_URL,\n    REQUEST_TOKEN_URL,\n    SPOTIFY_USER_TOKEN,\n    ADD_TRACK_TO_QUEUE_URL,\n    REMOVE_TRACK_FROM_QUEUE_URL,\n    VOTED_TRACKS,\n    SPOTIFY_PLAYER_BASE_URL,\n    SPOTIFY_PLAYER_PLAY_URL,\n    SPOTIFY_PLAYER_NEXT_TRACK_URL,\n    SPOTIFY_PLAYER_PREVIOUS_TRACK_URL,\n    SPOTIFY_PLAYER_PAUSE_URL,\n    SPOTIFY_PLAYER_SEEK_URL,\n    SPOTIFY_PLAYER_RECOMMENDATION_URL,\n    LAST_PLAYED_TRACK,\n    SPOTIFY_PLAYER_GET_DEVICES_URL,\n    SPOTIFY_PLAYER_SET_DEVICE_URL,\n    PING_URL\n} from './constants'\nexport * from './types'\n","/* URLs */\nexport const BASE_URL = process.env.NODE_ENV === 'production' ? process.env.REACT_APP_BASE_URL : 'http://localhost:8081/'\nexport const SOCKET_URL = process.env.NODE_ENV === 'production' ? process.env.REACT_APP_WS_URL : 'ws://localhost:8081'\nexport const HOST_URL = BASE_URL + 'host'\nexport const SEARCH_URL = BASE_URL + 'search'\nexport const VALIDATE_ROOM_URL = BASE_URL + 'validate'\nexport const AUTHORIZE_URL = BASE_URL + 'authorize'\nexport const REQUEST_TOKEN_URL = BASE_URL + 'token'\nexport const REFRESH_TOKEN_URL = BASE_URL + 'refresh'\nexport const GET_QUEUE_URL = BASE_URL + 'get-queue'\nexport const ADD_TRACK_TO_QUEUE_URL = BASE_URL + 'add-to-queue'\nexport const REMOVE_TRACK_FROM_QUEUE_URL = BASE_URL + 'remove-from-queue'\nexport const PING_URL = BASE_URL + 'ping'\n\n/* Spotify API */\nexport const SPOIFY_BASE_URL = 'https://api.spotify.com/v1'\nexport const SPOTIFY_PLAYER_RECOMMENDATION_URL = SPOIFY_BASE_URL + '/recommendations'\nexport const SPOTIFY_PLAYER_BASE_URL = SPOIFY_BASE_URL + '/me/player'\nexport const SPOTIFY_PLAYER_PLAY_URL = SPOTIFY_PLAYER_BASE_URL + '/play'\nexport const SPOTIFY_PLAYER_PAUSE_URL = SPOTIFY_PLAYER_BASE_URL + '/pause'\nexport const SPOTIFY_PLAYER_NEXT_TRACK_URL = SPOTIFY_PLAYER_BASE_URL + '/next'\nexport const SPOTIFY_PLAYER_PREVIOUS_TRACK_URL = SPOTIFY_PLAYER_BASE_URL + '/previous'\nexport const SPOTIFY_PLAYER_SEEK_URL = SPOTIFY_PLAYER_BASE_URL + '/seek'\nexport const SPOTIFY_PLAYER_GET_DEVICES_URL = SPOTIFY_PLAYER_BASE_URL + '/devices'\nexport const SPOTIFY_PLAYER_SET_DEVICE_URL = SPOTIFY_PLAYER_BASE_URL\n\n/* Localstorage */\nexport const SPOTIFY_USER_TOKEN = 'spotify_user_token'\nexport const VOTED_TRACKS = 'votes'\nexport const LAST_PLAYED_TRACK = 'last_played_track'\n","export const START = '/'\nexport const ROOM = '/room/:id'\nexport const LOGIN = '/login'\nexport const HOST = '/host/:id'\nexport const REDIRECT = '/redirect'\n\n// export type routeType = START | ROOM | LOGIN\n","import { SpotifyToken } from './types'\nimport { VOTED_TRACKS } from './constants'\n\nexport const validateRoomID = (s: string): boolean => {\n    // return s.length === 6 && Number.isInteger(Number(s.substr(1, 6))) && !s.includes(' ')\n    return s.length === 6 && !s.includes(' ')\n}\n\nexport const tokenHasExpired = (token: SpotifyToken): boolean => {\n    return token.expires_on < Date.now()\n}\n\nexport const Fetch = (url: string, method: string = 'GET', body?: any, signal?: AbortSignal) =>\n    fetch(url, {\n        signal,\n        method,\n        credentials: 'include',\n        headers: { 'Content-Type': 'application/json' },\n        body: body ? JSON.stringify(body) : undefined,\n    })\n        .then(gatherResponse)\n        .catch(console.error)\n\nasync function gatherResponse(response: any): Promise<any> {\n    if (response.status !== 200) {\n        throw new Error('Bad status = ' + response.status)\n    }\n    return await response.json()\n\n    // const { headers } = response\n    // const contentType = headers.get('content-type')\n    // if (contentType.includes('application/json')) {\n    //     return await response.json()\n    // } else if (contentType.includes('application/text')) {\n    //     return await response.json()\n    // } else if (contentType.includes('text/html')) {\n    //     return await response.json()\n    // } else {\n    //     return await response.json()\n    // }\n}\n\nexport const setVote = (id: string, vote: boolean) => {\n    let votes = getVotes()\n    if (vote) votes.push(id)\n    else votes = votes.filter(v => v !== id)\n    localStorage.setItem(VOTED_TRACKS, JSON.stringify(votes))\n}\n\nexport const getVotes = () => {\n    const votes = localStorage.getItem(VOTED_TRACKS)\n    if (!votes) {\n        setupLocalStorage()\n        return []\n    }\n    return JSON.parse(votes)\n}\n\nconst setupLocalStorage = () => {\n    localStorage.setItem(VOTED_TRACKS, JSON.stringify([]))\n}\n\nexport function millisToMinutesAndSeconds(millis) {\n    const minutes = Math.floor(millis / 60000)\n    const seconds = Math.floor((millis % 60000) / 1000)\n    return seconds === 60 ? `${minutes + 1}:00` : `${minutes}:${(seconds < 10 ? '0' : '') + seconds}`\n}\n","import { useState, useEffect, useRef } from 'react'\nimport { useAsyncAbortable } from 'react-async-hook'\nimport { useHistory } from 'react-router-dom'\nimport { useAPI, TrackType, getVotes, setVote as setVoteInStorage } from './'\n\nexport function useDebounce(value: string, delay: number) {\n    const [debouncedValue, setDebouncedValue] = useState(value)\n    useEffect(() => {\n        const handler = setTimeout(() => {\n            setDebouncedValue(value)\n        }, delay)\n        return () => {\n            clearTimeout(handler)\n        }\n    }, [value, delay])\n\n    return debouncedValue\n}\n\nexport const useDebouncedInput = (onUpdate: any, onCancel: any) => {\n    const [input, setInput] = useState('')\n    const debouncedInput = useDebounce(input, 400)\n\n    const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        if (input === '' && e.target.value.length > 0) {\n            onUpdate(e.target.value)\n        } else if (e.target.value.length === 0) {\n            onCancel()\n        }\n        setInput(e.target.value)\n    }\n\n    useEffect(() => {\n        if (debouncedInput && input.length > 0) {\n            onUpdate(debouncedInput)\n        }\n    }, [debouncedInput])\n\n    return { input, setInput, handleInputChange }\n}\n\nexport const useSearch = () => {\n    const [searchInput, setSearchInput] = useState('')\n    const [searching, setSearching] = useState(false)\n    const api = useAPI()\n\n    const search = useAsyncAbortable(\n        async (abortSignal, text) => {\n            if (text.length === 0) {\n                return []\n            } else {\n                return api.doSearchTrack(text, abortSignal)\n            }\n        },\n        [searchInput],\n    )\n\n    const handleCancelSearch = () => {\n        setSearchInput('')\n        setSearching(false)\n        search.reset()\n    }\n\n    const handleSearchUpdate = (input: string) => {\n        setSearchInput(input)\n        if (!searching) setSearching(true)\n    }\n\n    useEffect(() => {\n        const handleEscapePressed = (e: KeyboardEvent) => {\n            if (e.key === 'Escape' && searching) {\n                handleCancelSearch()\n            }\n        }\n        document.addEventListener('keydown', handleEscapePressed)\n        return () => {\n            document.removeEventListener('keydown', handleEscapePressed)\n        }\n    }, [searching])\n\n    return { searching, cancelSearch: handleCancelSearch, searchUpdate: handleSearchUpdate, search }\n}\n\nexport const useRoomValidation = () => {}\n\nexport const useWebSocket = (id: string) => {\n    const api = useAPI()\n    const queue = useQueue()\n    const history = useHistory()\n    const [subscribers, setSubscribers] = useState<number>(1)\n\n    useEffect(() => {\n        api.doValidateRoomID(id).then(isValid => {\n            if (isValid) api.doGetQueue().then(queue.setTracks)\n            else history.push('/not-found')\n        })\n        return () => api.doLeaveRoom()\n    }, [api, history, id, queue.setTracks])\n\n    useEffect(() => {\n        const callbacks = {\n            setSubscribers: (n: number) => setSubscribers(n),\n            addTrackToQueue: queue.addedToQueue,\n            removeTrackFromQueue: queue.removedFromQueue,\n            vote: queue.voted,\n        }\n        api.doJoinRoom(id, callbacks)\n    }, [queue.addedToQueue, queue.removedFromQueue, api, id, queue.voted])\n\n    return { subscribers, queue }\n}\n\nconst useVotes = () => {\n    const [votes, setVotes] = useState<string[]>([])\n    useEffect(() => {\n        setVotes(getVotes())\n    }, [])\n\n    const handleSetVote = (id: string, vote: boolean) => {\n        if (vote) setVotes([...votes, id])\n        else setVotes(votes.filter(v => v !== id))\n        setVoteInStorage(id, vote)\n    }\n\n    return { votes, setVotes: handleSetVote }\n}\n\nexport const useQueue = () => {\n    const [tracks, setTracks] = useState<TrackType[]>([])\n    const { votes, setVotes } = useVotes()\n    const api = useAPI()\n\n    const handleAddTrackToQueue = (track: TrackType) => {\n        api.doAddTrackToQueue(track.id).then(id => {\n            track.queue_id = id\n            setTracks([...tracks, track])\n            setVotes(id, true)\n        })\n    }\n\n    const handleTrackAddedToQueue = (track: TrackType) => {\n        setTracks([...tracks, track])\n    }\n\n    const handleRemoveTrackFromQueue = (id: string) => {\n        api.doRemoveTrackFromQueue(id)\n        setTracks(tracks.filter(t => t.queue_id !== id))\n        setVotes(id, false)\n    }\n\n    const handleTrackRemovedFromQueue = (id: string) => {\n        console.log('Removing from queue:', id)\n        setTracks(tracks.filter(t => t.queue_id !== id))\n    }\n\n    const handleVoteForTrack = (id: string, vote: boolean = true) => {\n        api.doVoteForTrack(id, vote)\n        const copy = [...tracks]\n        const index = copy.findIndex(t => t.queue_id === id)\n        copy[index].votes = copy[index].votes + (vote ? 1 : -1)\n        setTracks(copy)\n        setVotes(id, vote)\n    }\n\n    const handleReceivedVoteForTrack = (vote: { id: string; votes: number }) => {\n        const { id, votes } = vote\n        const copy = [...tracks]\n        const index = copy.findIndex(t => t.queue_id === id)\n        copy[index].votes = votes\n        setTracks(copy)\n    }\n\n    return {\n        // Probably anti-pattern to sort here, right?\n        // The queue can be sorted from firebase,\n        // but needs to be re-sorted on each vote\n        tracks: tracks ? tracks.sort((a, b) => b.votes - a.votes) : [],\n        addToQueue: handleAddTrackToQueue,\n        addedToQueue: handleTrackAddedToQueue,\n        removeFromQueue: handleRemoveTrackFromQueue,\n        removedFromQueue: handleTrackRemovedFromQueue,\n        vote: handleVoteForTrack,\n        voted: handleReceivedVoteForTrack,\n        votes,\n        setTracks,\n    }\n}\n\nexport const useInterval = (callback: () => void, delay: number) => {\n    const savedCallback = useRef(() => {})\n\n    useEffect(() => {\n        savedCallback.current = callback\n    }, [callback])\n\n    useEffect(() => {\n        function tick() {\n            savedCallback.current()\n        }\n        if (delay !== null) {\n            let id = setInterval(tick, delay)\n            return () => clearInterval(id)\n        }\n    }, [delay])\n}\n","import React, { useContext } from 'react'\n\nexport interface AuthType {\n    auth: boolean\n    roomId: string\n    doLogin: () => void\n    doSignOut: () => void\n}\n\nexport class Auth implements AuthType {\n    auth: boolean\n    roomId: string\n\n    constructor() {\n        this.auth = false\n        this.roomId = ''\n    }\n\n    doLogin = () => {}\n\n    doSignOut = () => {}\n}\n\nexport const AuthContext = React.createContext<AuthType>(new Auth())\n\nexport const useAuth = () => useContext(AuthContext)\n\nexport default AuthContext\n","import React, { useContext } from 'react'\nimport {\n    SOCKET_URL,\n    AUTHORIZE_URL,\n    REQUEST_TOKEN_URL,\n    SPOTIFY_USER_TOKEN,\n    REFRESH_TOKEN_URL,\n    GET_QUEUE_URL,\n    ADD_TRACK_TO_QUEUE_URL,\n    REMOVE_TRACK_FROM_QUEUE_URL,\n    HOST_URL,\n    VALIDATE_ROOM_URL,\n    SEARCH_URL,\n    PING_URL,\n    validateRoomID,\n    Fetch,\n    TrackType,\n    tokenHasExpired,\n    SpotifyToken,\n    APIType,\n} from './'\n\nconst Message = (type: string, payload: string | object): string => {\n    return JSON.stringify({\n        type,\n        payload,\n    })\n}\n\nexport class API implements APIType {\n    ws: WebSocket\n    host: boolean\n    window: Window | null\n    roomID: string\n    inSession: boolean\n\n    constructor() {\n        this.window = null\n        this.roomID = ''\n        this.inSession = false\n        this.ws = null\n        this.host = false\n    }\n\n    connect = () => {\n        this.ws = new WebSocket(SOCKET_URL)\n\n        this.ws.onopen = () => {\n            console.log('Open socket')\n        }\n\n        this.ws.onclose = (par: any) => {\n            console.log('Close socket', par)\n            this.ws = null\n            setTimeout(this.check, 1000)\n        }\n\n        this.ws.onerror = (err: any) => {\n            console.error('Socket error', err)\n            this.ws.close()\n        }\n    }\n\n    check = () => {\n        /* check if websocket instance is closed, if so call `connect` function. */\n        if (this.inSession && (!this.ws || this.ws.readyState === WebSocket.CLOSED)) this.connect()\n    }\n\n    ping = () => {\n        Fetch(PING_URL)\n    }\n\n    doSendMessage = (type: string, payload: string | object) => {\n        const message = Message(type, payload)\n        const interval = setInterval(() => {\n            if (this.ws && this.ws.readyState === WebSocket.OPEN) {\n                this.ws.send(message)\n                clearInterval(interval)\n            }\n        }, 1000)\n    }\n\n    doJoinRoom = (id: string, cb: any) => {\n        if (!this.ws) this.connect()\n\n        this.ws.onmessage = (e: any) => {\n            const message = JSON.parse(e.data)\n            switch (message.type) {\n                case 'spectator':\n                    break\n                case 'numSubscribers':\n                    cb.setSubscribers(message.payload as number)\n                    break\n                case 'leave':\n                    cb.setSubscribers(message.payload as number)\n                    break\n                case 'trackAdded':\n                    cb.addTrackToQueue(message.payload as TrackType)\n                    break\n                case 'trackRemoved':\n                    cb.removeTrackFromQueue(message.payload as string)\n                    break\n                case 'vote':\n                    cb.vote(message.payload as { votes: number; id: string })\n                    break\n                default:\n                    break\n            }\n        }\n\n        this.roomID = id\n\n        if (!this.inSession) {\n            this.doSendMessage('join', id)\n            this.inSession = true\n        }\n    }\n\n    doLeaveRoom = () => {\n        this.inSession = false\n        this.roomID = ''\n        this.ws.close()\n    }\n\n    doAuthorizeUser = () => {\n        return new Promise(resolve => {\n            const token: SpotifyToken = JSON.parse(localStorage.getItem(SPOTIFY_USER_TOKEN))\n\n            if (token && !tokenHasExpired(token)) {\n                return resolve(true)\n            } else if (token && tokenHasExpired(token)) {\n                return this.doRefreshUserToken(token).then(resolve)\n            }\n\n            const width = 450,\n                height = 730,\n                left = window.screen.width / 2 - width / 2,\n                top = window.screen.height / 2 - height / 2\n\n            const popup = window.open(\n                window.location.href,\n                'Spotify',\n                'menubar=no,location=no,resizable=no,scrollbars=no,status=no,width=' +\n                    `${width},height=${height},top=${top},left=${left}`,\n            )\n\n            return Fetch(AUTHORIZE_URL, 'GET').then((res: { data: string }) => {\n                if (popup) {\n                    popup.location.replace(res.data)\n                    window['tokenCallback'] = () => {\n                        popup.close()\n                        return resolve(true)\n                    }\n                } else {\n                    alert('Hey, you! This app needs popups, sorry. Just allow them. Once.')\n                }\n            })\n        })\n    }\n\n    doFetchUserToken = (code: string) => {\n        return Fetch(`${REQUEST_TOKEN_URL}?code=${code}`)\n            .then(res => res.data)\n            .then(token => {\n                token.expires_on = Date.now() + token.expires_in * 1000\n                localStorage.setItem(SPOTIFY_USER_TOKEN, JSON.stringify(token))\n            })\n    }\n\n    doRefreshUserToken = (token: SpotifyToken) => {\n        return Fetch(`${REFRESH_TOKEN_URL}?refresh_token=${token.refresh_token}`).then(\n            (res: { data: SpotifyToken }) => {\n                const newToken = res.data\n                newToken.refresh_token = token.refresh_token\n                newToken.expires_on = Date.now() + newToken.expires_in * 1000\n                localStorage.setItem(SPOTIFY_USER_TOKEN, JSON.stringify(newToken))\n                return newToken\n            },\n        )\n    }\n\n    doSetupRoom = async (): Promise<string> => {\n        const response: { data: string } = await Fetch(HOST_URL)\n        this.host = true\n        this.connect()\n        return response.data\n    }\n\n    doValidateRoomID = async (id: string): Promise<boolean> => {\n        return validateRoomID(id) && ((await Fetch(`${VALIDATE_ROOM_URL}?id=${id}`)) as { data: boolean }).data\n    }\n\n    doSearchTrack = async (search: string, signal: AbortSignal): Promise<TrackType[]> => {\n        const query = search.replace(' ', '+')\n        const response: { data: TrackType[] } = await Fetch(`${SEARCH_URL}?query=${query}`, 'GET', null, signal)\n        return response.data\n    }\n\n    doGetQueue = async (): Promise<TrackType[]> => {\n        const response: { data: { tracks: TrackType[] } } = await Fetch(`${GET_QUEUE_URL}?id=${this.roomID}`)\n        return response.data.tracks\n    }\n\n    doAddTrackToQueue = async (id: string): Promise<string> => {\n        const response: { data: string } = await Fetch(\n            `${ADD_TRACK_TO_QUEUE_URL}?trackID=${id}&sessionID=${this.roomID}`,\n            'PUT',\n        )\n        return response.data\n    }\n\n    doRemoveTrackFromQueue = async (id: string) => {\n        Fetch(`${REMOVE_TRACK_FROM_QUEUE_URL}?trackID=${id}&sessionID=${this.roomID}`, 'DELETE')\n    }\n\n    doVoteForTrack = async (id: string, vote: boolean) => {\n        this.doSendMessage('vote', { id, vote, room: this.roomID })\n    }\n}\n\nexport const APIContext = React.createContext<APIType>({} as APIType)\n\nexport const useAPI = (): APIType => useContext(APIContext)\n","module.exports = __webpack_public_path__ + \"static/media/placeholder.a1286edb.png\";","import React from 'react'\nimport { PersonIcon } from './'\nimport { useHistory } from 'react-router-dom'\nimport './styles/Header.scss'\n\ninterface Props {\n    size: 'xs' | 's' | 'm' | 'l' | 'xl'\n    color: 'white' | 'green'\n    numSubscribers?: number\n    id?: string\n}\n\nexport const Header: React.FC<Props> = ({ size, color, numSubscribers, id }: Props) => {\n    const history = useHistory()\n    return (\n        <div className={'header ' + color + ' ' + size}>\n            <h3 className=\"header-name\" onClick={history.goBack}>\n                Queue\n            </h3>\n            {id && (\n                <h3 className=\"header-code\">\n                    Go to <b>queue.rocks</b> and use the code <b>{id}</b>{' '}\n                </h3>\n            )}\n            {numSubscribers && (\n                <div className=\"header-person-icon\">\n                    {numSubscribers} <PersonIcon />\n                </div>\n            )}\n        </div>\n    )\n}\n","import React from 'react'\nimport { Dots } from './'\nimport './styles/Button.scss'\n\ninterface Props {\n    onClick: () => void\n    type?: 'green' | 'white' | 'transparent'\n    value?: string\n    loading?: boolean\n    className?: string\n}\n\nexport const Button: React.FC<Props> = ({\n    onClick,\n    type = 'green',\n    value = '',\n    loading = false,\n    className = '',\n}: Props) => {\n    return (\n        <button onClick={onClick} className={'button button-' + type + ' ' + className}>\n            <div>{loading ? <Dots /> : value}</div>\n        </button>\n    )\n}\n","import React from 'react'\nimport { Header } from '../Common/'\nimport './styles/URLNotFound.scss'\n\ninterface Props {}\n\nexport const URLNotFound: React.FC<Props> = () => {\n    return (\n        <div className=\"404\">\n            <Header color=\"green\" size=\"s\" />\n            <h3>404</h3>\n        </div>\n    )\n}\n","import React from 'react'\nimport './styles/Spinner.scss'\n\nexport const Dots = () => (\n    <div className=\"lds-ellipsis\">\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n    </div>\n)\n","import React from 'react'\n\nexport const Close = () => (\n    <svg viewBox=\"0 0 512 512\" className=\"icon-fill\">\n        <path d=\"M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z\" />\n    </svg>\n)\n\nexport const Next = () => (\n    <svg viewBox=\"0 0 170 174\" className=\"icon-fill\">\n        <path d=\"M132.916 87L20 153.684L20 20.316L132.916 87Z\" />\n        <rect x=\"132.916\" y=\"20\" width=\"16.6257\" height=\"134\" />\n    </svg>\n)\n\nexport const Previous = () => (\n    <svg viewBox=\"0 0 170 174\" className=\"icon-fill\">\n        <path d=\"M36.6257 87L149.542 20.316L149.542 153.684L36.6257 87Z\" />\n        <rect x=\"36.6257\" y=\"154\" width=\"16.6257\" height=\"134\" transform=\"rotate(-180 36.6257 154)\" />\n    </svg>\n)\n\nexport const Shuffle = () => (\n    <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" className=\"icon-fill\">\n        <g>\n            <g>\n                <g>\n                    <path\n                        d=\"M21.333,149.327H64c18.773,0,37.227,4.928,53.333,14.272c3.371,1.963,7.061,2.88,10.688,2.88\n\t\t\t\tc7.36,0,14.528-3.819,18.475-10.624c5.931-10.197,2.432-23.253-7.744-29.163C116.117,113.594,90.283,106.66,64,106.66H21.333\n\t\t\t\tC9.536,106.66,0,116.218,0,127.994S9.536,149.327,21.333,149.327z\"\n                    />\n                    <path\n                        d=\"M320,149.327h42.667v64c0,8.192,4.715,15.68,12.075,19.221c2.965,1.408,6.123,2.112,9.259,2.112\n\t\t\t\tc4.757,0,9.472-1.6,13.333-4.672L504,144.655c5.056-4.053,8-10.176,8-16.661c0-6.485-2.944-12.608-8-16.661L397.333,25.999\n\t\t\t\tc-6.421-5.12-15.232-6.101-22.592-2.56s-12.075,11.029-12.075,19.221v64H320c-82.325,0-149.333,66.987-149.333,149.333\n\t\t\t\tc0,58.816-47.851,106.667-106.667,106.667H21.333C9.536,362.66,0,372.218,0,383.994s9.536,21.333,21.333,21.333H64\n\t\t\t\tc82.325,0,149.333-66.987,149.333-149.333C213.333,197.178,261.184,149.327,320,149.327z\"\n                    />\n                    <path\n                        d=\"M504,367.336l-106.667-85.333c-6.421-5.141-15.232-6.123-22.592-2.581c-7.36,3.563-12.075,11.029-12.075,19.243v64H320\n\t\t\t\tc-21.077,0-41.472-6.144-58.965-17.771c-9.856-6.485-23.061-3.861-29.568,5.973c-6.528,9.813-3.861,23.061,5.952,29.568\n\t\t\t\tc24.512,16.277,53.056,24.896,82.581,24.896h42.667v64c0,8.192,4.715,15.68,12.075,19.221c2.965,1.408,6.123,2.112,9.259,2.112\n\t\t\t\tc4.757,0,9.472-1.6,13.333-4.672L504,400.659c5.056-4.053,8-10.197,8-16.661C512,377.512,509.056,371.368,504,367.336z\"\n                    />\n                </g>\n            </g>\n        </g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n    </svg>\n)\n\nexport const Connect = () => (\n    <svg viewBox=\"0 0 123 118\" className=\"icon-connect\">\n        <path\n            d=\"M50 10H14C11.7909 10 10 11.7909 10 14V80C10 82.2091 11.7909 84 14 84H50\"\n            strokeWidth=\"8\"\n            strokeLinejoin=\"round\"\n        />\n        <rect x=\"61\" y=\"10\" width=\"52\" height=\"98\" rx=\"6\" strokeWidth=\"8\" />\n        <path d=\"M35 108H50\" strokeWidth=\"8\" />\n        <circle cx=\"87\" cy=\"77\" r=\"14\" strokeWidth=\"8\" />\n        <circle cx=\"87\" cy=\"35\" r=\"5\" className=\"icon-fill\" />\n    </svg>\n)\n\nexport const Repeat = () => (\n    <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 511.991 511.991\" className=\"icon-fill\">\n        <g>\n            <g>\n                <g>\n                    <path\n                        d=\"M465.45,279.263c-12.87,0-23.273,10.426-23.273,23.273c0,38.493-31.325,69.818-69.818,69.818H186.177v-69.818\n\t\t\t\tc0-8.937-5.143-17.105-13.172-20.969c-8.122-3.863-17.641-2.793-24.646,2.793L31.995,377.451\n\t\t\t\tc-5.516,4.422-8.727,11.101-8.727,18.176c0,7.075,3.212,13.754,8.727,18.176l116.364,93.091\n\t\t\t\tc4.212,3.351,9.356,5.097,14.545,5.097c3.421,0,6.889-0.768,10.1-2.304c8.029-3.863,13.172-12.032,13.172-20.969V418.9h186.182\n\t\t\t\tc64.163,0,116.364-52.201,116.364-116.364C488.723,289.689,478.32,279.263,465.45,279.263z\"\n                    />\n                    <path\n                        d=\"M46.541,232.718c12.87,0,23.273-10.426,23.273-23.273c0-38.493,31.325-69.818,69.818-69.818h186.182v69.818\n\t\t\t\tc0,8.937,5.143,17.105,13.172,20.969c3.235,1.536,6.679,2.304,10.1,2.304c5.19,0,10.333-1.745,14.545-5.097l116.364-93.091\n\t\t\t\tc5.516-4.422,8.727-11.101,8.727-18.176s-3.212-13.754-8.727-18.176L363.632,5.087c-6.982-5.585-16.617-6.656-24.646-2.793\n\t\t\t\ts-13.172,12.032-13.172,20.969v69.818H139.632c-64.163,0-116.364,52.201-116.364,116.364\n\t\t\t\tC23.268,222.292,33.671,232.718,46.541,232.718z\"\n                    />\n                </g>\n            </g>\n        </g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n    </svg>\n)\n\nexport const Speaker = () => (\n    <svg viewBox=\"0 0 76 120\">\n        <rect x=\"12\" y=\"11\" width=\"52\" height=\"98\" rx=\"4\" strokeWidth=\"6\" />\n        <circle cx=\"38\" cy=\"78\" r=\"14\" strokeWidth=\"6\" />\n        <circle cx=\"38\" cy=\"36\" r=\"5\" className=\"icon-fill\" />\n    </svg>\n)\n\nexport const Phone = () => (\n    <svg viewBox=\"0 0 76 120\">\n        <rect x=\"12\" y=\"11\" width=\"52\" height=\"98\" rx=\"4\" strokeWidth=\"6\" />\n        <circle cx=\"38\" cy=\"96\" r=\"5\" className=\"icon-fill\" />\n    </svg>\n)\n\nexport const Computer = () => (\n    <svg viewBox=\"0 0 228 180\">\n        <rect x=\"35\" y=\"21\" width=\"157\" height=\"113\" rx=\"4\" strokeWidth=\"6\" />\n        <path d=\"M15 158H213\" strokeWidth=\"6\" />\n    </svg>\n)\n\nexport const Play = () => (\n    <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 320.001 320.001\" className=\"icon-fill\">\n        <path\n            d=\"M295.84,146.049l-256-144c-4.96-2.784-11.008-2.72-15.904,0.128C19.008,5.057,16,10.305,16,16.001v288\n\tc0,5.696,3.008,10.944,7.936,13.824c2.496,1.44,5.28,2.176,8.064,2.176c2.688,0,5.408-0.672,7.84-2.048l256-144\n\tc5.024-2.848,8.16-8.16,8.16-13.952S300.864,148.897,295.84,146.049z\"\n        />\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n    </svg>\n)\n\nexport const Pause = () => (\n    <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 47.607 47.607\" className=\"icon-fill\">\n        <g>\n            <path\n                d=\"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0\n\t\tl0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z\"\n            />\n            <path\n                d=\"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631\n\t\tC29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z\"\n            />\n        </g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n        <g></g>\n    </svg>\n)\n\nexport const PersonIcon = () => {\n    return (\n        <svg enableBackground=\"new 0 0 512 512\" viewBox=\"0 0 512 512\">\n            <g>\n                <path\n                    d=\"M348.574,145.901c0,53.522-43.377,96.914-96.901,96.914c-53.523,0-96.914-43.392-96.914-96.914    c0-53.51,43.391-96.901,96.914-96.901C305.197,49,348.574,92.391,348.574,145.901z\"\n                    fill=\"none\"\n                    stroke=\"#fff\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeMiterlimit=\"10\"\n                    strokeWidth=\"20\"\n                />\n                <path\n                    d=\"M275.38,274.46c95.561,9.706,170.154,90.401,170.154,188.54\"\n                    fill=\"none\"\n                    stroke=\"#fff\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeMiterlimit=\"10\"\n                    strokeWidth=\"20\"\n                />\n                <path\n                    d=\"M66.466,463c0-96.358,71.925-175.934,165.027-187.961\"\n                    fill=\"none\"\n                    stroke=\"#fff\"\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeMiterlimit=\"10\"\n                    strokeWidth=\"20\"\n                />\n            </g>\n        </svg>\n    )\n}\n\nexport const Heart = () => (\n    <svg viewBox=\"0 0 512 512\">\n        <path d=\"M340.8,83C307,83,276,98.8,256,124.8c-20-26-51-41.8-84.8-41.8C112.1,83,64,131.3,64,190.7c0,27.9,10.6,54.4,29.9,74.6  L245.1,418l10.9,11l10.9-11l148.3-149.8c21-20.3,32.8-47.9,32.8-77.5C448,131.3,399.9,83,340.8,83L340.8,83z\" />\n    </svg>\n)\n\nexport const HeartOutline = () => (\n    <svg viewBox=\"0 0 512 512\">\n        <path d=\"M340.8,98.4c50.7,0,91.9,41.3,91.9,92.3c0,26.2-10.9,49.8-28.3,66.6L256,407.1L105,254.6c-15.8-16.6-25.6-39.1-25.6-63.9  c0-51,41.1-92.3,91.9-92.3c38.2,0,70.9,23.4,84.8,56.8C269.8,121.9,302.6,98.4,340.8,98.4 M340.8,83C307,83,276,98.8,256,124.8  c-20-26-51-41.8-84.8-41.8C112.1,83,64,131.3,64,190.7c0,27.9,10.6,54.4,29.9,74.6L245.1,418l10.9,11l10.9-11l148.3-149.8  c21-20.3,32.8-47.9,32.8-77.5C448,131.3,399.9,83,340.8,83L340.8,83z\" />\n    </svg>\n)\n","import React, { useState, useEffect } from 'react'\nimport { Join, Host } from './'\nimport { ROUTES, useAPI } from '../../utils'\nimport { RouteComponentProps } from 'react-router'\nimport './styles/Start.scss'\n\nconst ERROR_SESSION = 'The session could not be found'\nconst ERROR_AUTH = 'User could not be authenticated'\n\ninterface MatchParams {\n    id: string\n}\n\ninterface Props extends RouteComponentProps<MatchParams> {\n    onSelect?: (s: string) => void\n}\n\nexport const Start: React.FC<Props> = ({ onSelect, history }: Props) => {\n    const api = useAPI()\n\n    const [error, setError] = useState('')\n    const [loading, setLoading] = useState(false)\n\n    useEffect(() => {\n        // Wake up idle Heroku dyno\n        api.ping()\n    }, [])\n\n    const handleHostRoom = async (): Promise<any> => {\n        console.log('Authorizing...')\n        api.doAuthorizeUser()\n            .then(async () => {\n                console.log('Authorized!')\n                const id = await api.doSetupRoom()\n                history.push(ROUTES.HOST.replace(':id', id))\n            })\n            .catch(err => {\n                setError(ERROR_AUTH)\n            })\n    }\n\n    const handleJoinRoom = async (id: string): Promise<any> => {\n        setLoading(true)\n        if (await api.doValidateRoomID(id)) {\n            history.push(ROUTES.ROOM.replace(':id', id))\n        } else {\n            setLoading(false)\n            setError(ERROR_SESSION)\n        }\n    }\n\n    return (\n        <div className=\"start\">\n            <h3 className=\"xl green\">Queue</h3>\n            <div className=\"start-buttons\">\n                <Host onSelect={handleHostRoom} />\n                <Join onSelect={handleJoinRoom} loading={loading} />\n            </div>\n            {error && <div className=\"start-error\">{error}</div>}\n        </div>\n    )\n}\n","import React, { useState } from 'react'\nimport { Button } from '../Common/'\n\ntype Props = {\n    onSelect: () => void\n}\n\nexport const Host: React.FC<Props> = ({ onSelect }: Props) => {\n    const [isLoading, setLoading] = useState(false)\n\n    const handleClick = () => {\n        setLoading(true)\n        onSelect()\n    }\n\n    return <Button onClick={handleClick} value=\"Host\" type=\"transparent\" loading={isLoading} />\n}\n","import React, { useState, useRef, useEffect, useCallback } from 'react'\nimport { Button } from '../Common/'\nimport { TextInput } from './'\n\ntype Props = {\n    onSelect: (s: string) => void\n    loading: boolean\n}\n\nexport const Join: React.FC<Props> = ({ onSelect, loading }: Props) => {\n    const [input, setInput] = useState<string>('')\n    const [inputVisible, setInputVisible] = useState<boolean>(false)\n    const joinRef = useRef<HTMLDivElement>(document.createElement('div'))\n\n    const handleSubmit = useCallback((): void => {\n        if (inputVisible && input.length > 0) {\n            onSelect(input)\n        } else {\n            setInputVisible(true)\n        }\n    }, [inputVisible, input, onSelect])\n\n    const handleClickOutside = useCallback(\n        (e: MouseEvent): void => {\n            if (!joinRef.current.contains(e.target as Node) && inputVisible) {\n                setInputVisible(false)\n            }\n        },\n        [inputVisible],\n    )\n\n    const handleEnterPressed = useCallback(\n        (e: KeyboardEvent): void => {\n            if (e.key === 'Enter') {\n                handleSubmit()\n            }\n        },\n        [handleSubmit],\n    )\n\n    useEffect(() => {\n        document.addEventListener('click', handleClickOutside)\n        document.addEventListener('keydown', handleEnterPressed)\n        return () => {\n            document.removeEventListener('click', handleClickOutside)\n            document.removeEventListener('keydown', handleEnterPressed)\n        }\n    }, [handleEnterPressed, handleClickOutside])\n\n    return (\n        <div ref={joinRef} className={'join-button' + (inputVisible ? ' show' : '')}>\n            <Button\n                className={loading ? 'loading' : ''}\n                onClick={handleSubmit}\n                value={inputVisible ? '\\uFF0B' : 'Join'}\n                type=\"green\"\n            />\n            <TextInput onChange={setInput} placeholder=\"Room code\" value={input} visible={inputVisible} />\n        </div>\n    )\n}\n","import React from 'react'\nimport './styles/TextInput.scss'\n\ninterface Props {\n    onChange: (s: string) => void\n    value: string | undefined,\n    placeholder?: string\n    visible?: boolean\n}\n\nexport const TextInput: React.FC<Props> = ({ onChange, value, visible=true, placeholder='' }: Props) => {\n    return (\n        <input\n            className={visible ? 'text-input visible' : 'text-input'}\n            type=\"text\"\n            value={value}\n            onChange={(e: React.ChangeEvent<HTMLInputElement>): void => {\n                onChange(e.target.value)\n            }}\n            placeholder={placeholder}\n        />\n    )\n}\n","import React, { useEffect } from 'react'\nimport { RouteComponentProps } from 'react-router-dom'\nimport { useAPI } from '../../utils'\n\nexport interface RedirectProps extends RouteComponentProps {}\n\nexport const Redirect: React.FC<RedirectProps> = props => {\n    const api = useAPI()\n\n    useEffect(() => {\n        const query = new URLSearchParams(props.location.search)\n        const code = query.get('code')\n        api.doFetchUserToken(code).then(() => {\n            window.opener.tokenCallback()\n            window.close()\n        })\n    }, [api, props.location])\n    return <div></div>\n}\n","import React, { useEffect, useCallback, useRef, useState } from 'react'\nimport { useDebouncedInput } from '../../utils'\nimport './styles/SearchInput.scss'\n\ninterface SearchProps {\n    onCancel: () => void\n    onSearchUpdate: (s: string) => void\n    searching: boolean\n}\n\nexport const SearchInput: React.FC<SearchProps> = ({ onCancel, onSearchUpdate, searching }) => {\n    const inputRef = useRef<HTMLInputElement>(document.createElement('input'))\n    const { input, setInput, handleInputChange } = useDebouncedInput(onSearchUpdate, onCancel)\n    const [hasFocus, setFocus] = useState(false)\n\n    const handleCancel = useCallback(() => {\n        inputRef.current.blur()\n        setInput('')\n        onCancel()\n    }, [onCancel, setInput])\n\n    const handleKeyPressed = useCallback(\n        (e: KeyboardEvent) => {\n            if (e.key === 'Escape') {\n                handleCancel()\n            }\n        },\n        [handleCancel],\n    )\n\n    useEffect(() => {\n        const current = inputRef.current\n        current.addEventListener('keydown', handleKeyPressed)\n\n        return () => {\n            current.removeEventListener('keydown', handleKeyPressed)\n        }\n    }, [handleKeyPressed])\n\n    useEffect(() => {\n        if (!searching && input.length > 0) {\n            setInput('')\n        }\n    })\n\n    return (\n        <div className=\"search-input\">\n            <input\n                ref={inputRef}\n                tabIndex={1}\n                onFocus={() => setFocus(true)}\n                onBlur={() => setFocus(false)}\n                onChange={handleInputChange}\n                value={input}\n                type=\"text\"\n                placeholder=\"Sk\"\n            />\n            {(searching || hasFocus) && <button onClick={handleCancel}>&#x2573;</button>}\n        </div>\n    )\n}\n","import React, { useState, useEffect } from 'react'\nimport { TrackType } from '../../utils'\nimport { Heart, HeartOutline } from '../Common'\nimport './styles/SearchResults.scss'\n\ninterface SearchResultProps {\n    tracks: TrackType[]\n    onAddTrack: (track: TrackType) => void\n    onRemoveTrack: (id: string) => void\n}\n\nexport const SearchResults: React.FC<SearchResultProps> = ({\n    tracks,\n    onAddTrack,\n    onRemoveTrack,\n}: SearchResultProps) => {\n    const [queuedTracks, setQueuedTracks] = useState(tracks.map(t => t.id))\n\n    useEffect(() => {\n        setQueuedTracks(Array(tracks.length).fill(false))\n    }, [tracks])\n\n    const handleAddTrack = (index: number) => {\n        if (queuedTracks[index]) {\n            onRemoveTrack(tracks[index].queue_id)\n        } else {\n            onAddTrack(tracks[index])\n        }\n        const copy = [...queuedTracks]\n        copy[index] = !copy[index]\n        setQueuedTracks(copy)\n    }\n\n    return (\n        <div className=\"list-container\">\n            <ul className=\"track-list search-results\">\n                {tracks.map((track, index) => (\n                    <li key={track.queue_id}>\n                        <img src={getArtwork(track.album_s)} alt=\"\" />\n                        <div className=\"track-names\">\n                            <div>\n                                <h3>{track.title}</h3>\n                            </div>\n                            <div>{track.artist}</div>\n                        </div>\n                        <button onClick={() => handleAddTrack(index)}>\n                            <div>{queuedTracks[index] ? <Heart /> : <HeartOutline />}</div>\n                        </button>\n                    </li>\n                ))}\n            </ul>\n        </div>\n    )\n}\n\nfunction getArtwork(album: string) {\n    if (album.length > 0) {\n        return album\n    } else {\n        return require('../../assets/img/placeholder.png')\n    }\n}\n","import React from 'react'\nimport { PulseLoader as Spinner } from 'react-spinners'\nimport { SearchInput, SearchResults } from './'\nimport { useSearch } from '../../utils'\nimport './styles/Search.scss'\n\ninterface Props {\n    queue: any\n}\n\nexport const Search: React.FC<Props> = ({ children, queue }) => {\n    const { searching, searchUpdate, cancelSearch, search } = useSearch()\n    return (\n        <div className=\"search\">\n            <SearchInput onSearchUpdate={searchUpdate} onCancel={cancelSearch} searching={searching} />\n            {searching ? (\n                search.loading ? (\n                    <Spinner css={'margin-top: 10vh;'} size={10} color={'white'} />\n                ) : search.result && search.result.length > 0 ? (\n                    <SearchResults\n                        onAddTrack={queue.addToQueue}\n                        onRemoveTrack={queue.removeFromQueue}\n                        tracks={search.result}\n                    />\n                ) : (\n                    <p>No results</p>\n                )\n            ) : (\n                children\n            )}\n        </div>\n    )\n}\n","import React from 'react'\nimport { Header } from '../Common/'\nimport { RouteComponentProps } from 'react-router'\nimport { useWebSocket } from '../../utils'\nimport { Search } from '../Search'\nimport './styles/Host.scss'\nimport { Player, TrackList, useSpotify } from './'\n\ninterface MatchParams {\n    id: string\n}\n\ninterface Props extends RouteComponentProps<MatchParams> {}\n\nexport const Host: React.FC<Props> = (props: Props) => {\n    const { subscribers, queue } = useWebSocket(props.match.params.id)\n    const { playerState, controller, fetching } = useSpotify()\n\n    return (\n        <div className=\"host\">\n            <Header color=\"green\" size=\"s\" numSubscribers={subscribers} id={props.match.params.id} />\n            <div className=\"host-content\">\n                <Player tracks={queue.tracks} playerState={playerState} controller={controller} fetching={fetching} />\n                <Search queue={queue}>\n                    <TrackList tracks={queue.tracks} onDelete={queue.removeFromQueue} onPlay={controller.playTrack} />\n                </Search>\n            </div>\n        </div>\n    )\n}\n","import React from 'react'\nimport { TrackType } from '../../utils'\nimport { Play, Close } from '../Common'\nimport './styles/TrackList.scss'\n\ninterface TrackListProps {\n    tracks: TrackType[]\n    onDelete: (id: string) => void\n    onPlay: (id: string, queue_id: string) => void\n}\n\nexport const TrackList: React.FC<TrackListProps> = ({ tracks, onDelete, onPlay }: TrackListProps) => {\n    return (\n        <ul className=\"host-track-list\">\n            <li>\n                <div>TITLE</div>\n                <div>ARTIST</div>\n                <div>VOTES</div>\n            </li>\n            {tracks.length > 0 ? (\n                tracks.map((track, index) => (\n                    <li key={track.queue_id} className=\"track-list-item\">\n                        <div>{track.title}</div>\n                        <div>{track.artist}</div>\n                        <div>{track.votes}</div>\n                        <button onClick={() => onPlay(track.id, track.queue_id)}>\n                            <Play />\n                        </button>\n                        <button onClick={() => onDelete(track.queue_id)}>\n                            <Close />\n                        </button>\n                    </li>\n                ))\n            ) : (\n                <li>\n                    <h3>The Queue is empty</h3>\n                </li>\n            )}\n        </ul>\n    )\n}\n","import React, { useState, useEffect } from 'react'\nimport { TrackType, millisToMinutesAndSeconds, useInterval } from '../../utils'\nimport { Play, Pause, Connect, Shuffle, Next, Previous, Computer, Speaker, Phone } from '../Common'\nimport { PulseLoader as Spinner } from 'react-spinners'\nimport { Image } from './'\nimport './styles/Player.scss'\nimport { SpotifyPlayer } from '../../utils/Spotify'\n\nconst PLACEHOLDER_TRACK = {\n    src: require('../../assets/img/placeholder.png'),\n    artist: 'Artist',\n    track: 'Track',\n}\n\ninterface PlayerProps {\n    tracks: TrackType[]\n    playerState: SpotifyApi.CurrentPlaybackResponse\n    controller: SpotifyPlayer\n    fetching: boolean\n}\n\nexport const Player: React.FC<PlayerProps> = ({ tracks, playerState, controller, fetching }) => {\n    const renderPlayer = () => {\n        if (playerState && 'is_playing' in playerState && playerState.item) {\n            const track = playerState.item\n            return (\n                <div className=\"player\">\n                    <Image src={track.album.images[0].url} />\n                    <h3>{track.artists[0].name}</h3>\n                    <p>{track.name}</p>\n                    <Controller tracks={tracks} state={playerState} controller={controller} />\n                </div>\n            )\n        }\n        return (\n            <div className=\"player\">\n                <Image src={PLACEHOLDER_TRACK.src} />\n                <h3>{PLACEHOLDER_TRACK.artist}</h3>\n                <p>{PLACEHOLDER_TRACK.track}</p>\n                <DisabledController controller={controller} />\n            </div>\n        )\n    }\n\n    return (\n        <>\n            <Overlay fetching={fetching} />\n            {renderPlayer()}\n        </>\n    )\n}\n\ninterface OverlayProps {\n    fetching: boolean\n}\n\nconst Overlay: React.FC<OverlayProps> = ({ fetching }) => {\n    const [showOverlay, setShowOverlay] = useState(fetching)\n\n    useEffect(() => {\n        setTimeout(() => setShowOverlay(false), 1000)\n    }, [fetching])\n\n    return showOverlay ? <div className={'player-loading-overlay' + (fetching ? '' : ' disabled')}></div> : null\n}\n\ninterface DisabledControllerProps {\n    controller: SpotifyPlayer\n}\n\nconst DisabledController: React.FC<DisabledControllerProps> = ({ controller }) => {\n    return (\n        <div className=\"player-controller\">\n            <div className=\"player-controller-controlls\">\n                <ControllButton onClick={() => {}} type=\"shuffle\" />\n                <ControllButton onClick={() => {}} type=\"prev\" />\n                <ControllButton onClick={() => {}} type={'play'} />\n                <ControllButton onClick={() => {}} type=\"next\" />\n                <ConnectButton controller={controller} />\n            </div>\n            <ProgressBar isPlaying={false} length={0} current={0} onSeek={(ms: number) => {}} onEnd={() => {}} />\n        </div>\n    )\n}\n\ninterface ControllerProps {\n    state: SpotifyApi.CurrentPlaybackResponse\n    controller: SpotifyPlayer\n    tracks: TrackType[]\n}\n\nexport const Controller: React.FC<ControllerProps> = ({ state, controller, tracks }) => {\n    const [isPlaying, setIsPlaying] = useState(state.is_playing)\n\n    useEffect(() => {\n        setIsPlaying(state.is_playing)\n    }, [state.is_playing])\n\n    const handleTogglePlayback = () => {\n        controller.togglePlayback(isPlaying)\n        setIsPlaying(!isPlaying)\n    }\n\n    const handlePlayNextTrack = () => {\n        if (tracks.length > 0) {\n            controller.playTrack(tracks[0].id, tracks[0].queue_id)\n        } else {\n            controller.playSimilarTrack()\n        }\n    }\n\n    return (\n        <div className=\"player-controller\">\n            <div className=\"player-controller-controlls\">\n                <ControllButton onClick={() => console.log(controller)} type=\"shuffle\" />\n                <ControllButton onClick={() => controller.changeTrack(false)} type=\"prev\" />\n                <ControllButton onClick={handleTogglePlayback} type={isPlaying ? 'pause' : 'play'} />\n                <ControllButton onClick={handlePlayNextTrack} type=\"next\" />\n                <ConnectButton controller={controller} />\n            </div>\n            <ProgressBar\n                isPlaying={isPlaying}\n                length={state.item.duration_ms}\n                current={state.progress_ms}\n                onSeek={controller.seekInPlayingTrack}\n                onEnd={handlePlayNextTrack}\n            />\n        </div>\n    )\n}\n\ninterface PopUpProps {\n    devices: SpotifyApi.UserDevice[]\n    onClick: (id: string) => void\n}\n\nconst PopUp: React.FC<PopUpProps> = ({ devices, onClick }) => {\n    const getIcon = (type: string) => {\n        switch (type) {\n            case 'Computer':\n                return <Computer />\n            case 'Speaker':\n                return <Speaker />\n            case 'Smartphone':\n                return <Phone />\n            default:\n                return <Speaker />\n        }\n    }\n\n    return (\n        <div>\n            <ul>\n                {devices.length > 0 ? (\n                    devices.map((device, index) => (\n                        <li key={device.id}>\n                            <button\n                                className={\n                                    device.is_restricted ? 'device-restricted' : device.is_active ? 'device-active' : ''\n                                }\n                                disabled={device.is_restricted}\n                                onClick={() => onClick(device.id)}\n                            >\n                                {getIcon(device.type)}\n                                <p>{device.name}</p>\n                            </button>\n                        </li>\n                    ))\n                ) : (\n                    <li className=\"loading\">\n                        <Spinner size={10} color={'white'} />\n                    </li>\n                )}\n            </ul>\n        </div>\n    )\n}\n\ninterface ConnectButtonProps {\n    controller: SpotifyPlayer\n}\n\nconst ConnectButton: React.FC<ConnectButtonProps> = ({ controller }) => {\n    const [isVisible, setIsVisible] = useState(false)\n    const [devices, setDevices] = useState([])\n\n    const handleTogglePopUp = () => {\n        if (!isVisible) controller.getDevices().then(setDevices)\n        setIsVisible(!isVisible)\n    }\n\n    const handleSelectDevice = (id: string) => {\n        controller\n            .setDevice(id)\n            .then(controller.getDevices)\n            .then(setDevices)\n    }\n\n    useEffect(() => {\n        let mounted = true\n        controller.getDevices().then(devices => {\n            if (mounted) setDevices(devices)\n        })\n        return () => (mounted = false)\n    }, [controller.getDevices])\n\n    return (\n        <div className=\"player-controll-connect\">\n            {isVisible && <PopUp devices={devices} onClick={handleSelectDevice} />}\n            <ControllButton onClick={handleTogglePopUp} type=\"connect\" />\n        </div>\n    )\n}\n\ninterface ControllButtonProps {\n    type: 'shuffle' | 'prev' | 'play' | 'pause' | 'next' | 'connect'\n    onClick: () => void\n}\n\nexport const ControllButton: React.FC<ControllButtonProps> = ({ type, onClick }: ControllButtonProps) => {\n    const isCircled = type === 'play' || type === 'pause'\n    const renderIcon = () => {\n        switch (type) {\n            case 'next':\n                return <Next />\n            case 'play':\n                return <Play />\n            case 'prev':\n                return <Previous />\n            case 'pause':\n                return <Pause />\n            case 'shuffle':\n                return <Shuffle />\n            case 'connect':\n                return <Connect />\n        }\n    }\n    return (\n        <button onClick={onClick} className={'player-controll-button ' + type + (isCircled ? ' circle' : '')}>\n            {renderIcon()}\n        </button>\n    )\n}\n\ninterface ProgressBarProps {\n    current: number\n    length: number\n    isPlaying: boolean\n    onSeek: (ms: number) => void\n    onEnd: () => void\n}\n\nconst OFFSET = 1000\n\nexport const ProgressBar: React.FC<ProgressBarProps> = ({\n    current,\n    length,\n    isPlaying,\n    onSeek,\n    onEnd,\n}: ProgressBarProps) => {\n    const [progress, setProgress] = useState(current)\n\n    const styles = {\n        // transform: `scaleX(${progress / length})`,\n        width: `${(100 * progress) / length}%`,\n    }\n\n    useInterval(() => {\n        if (isPlaying) {\n            const next = progress + 1000 + OFFSET\n            if (next < length) setProgress(next - OFFSET)\n            else {\n                setProgress(0)\n                onEnd()\n            }\n        }\n    }, 1000)\n\n    useEffect(() => {\n        if (progress > 0 && isPlaying) {\n            setProgress(current)\n        }\n    }, [current, length])\n\n    useEffect(() => {\n        setProgress(progress)\n    }, [isPlaying])\n\n    const handleSeekTrack = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n        const progressBar = e.currentTarget\n        const progressBarWidth = progressBar.offsetWidth\n        const progressBarClickPosition = e.clientX - progressBar.getBoundingClientRect().left\n        const progressBarProgressClicked = progressBarClickPosition / progressBarWidth\n        const progressInMs = Math.round(progressBarProgressClicked * length)\n        onSeek(progressInMs)\n        setProgress(progressInMs)\n    }\n\n    return (\n        <div className=\"progress-bar-container\">\n            <div>{millisToMinutesAndSeconds(progress)}</div>\n            <div className=\"progress-bar\" onClick={handleSeekTrack}>\n                <div style={styles}></div>\n            </div>\n            <div>{millisToMinutesAndSeconds(length)}</div>\n        </div>\n    )\n}\n","import React, { useRef, useEffect } from 'react'\nimport VanillaTilt from 'vanilla-tilt'\nimport './styles/Image.scss'\n\nconst OPTIONS = {\n    perspective: 2000,\n    speed: 500,\n    max: 5,\n}\n\nexport interface Props {\n    src: string\n}\n\nexport const Image: React.FC<Props> = ({ src }: Props) => {\n    const tilt = useRef<HTMLDivElement>(document.createElement('div'))\n\n    useEffect(() => {\n        VanillaTilt.init(tilt.current, OPTIONS)\n    })\n\n    return (\n        <div ref={tilt} className=\"album-tilt\">\n            <img src={src} alt=\"Album artwork\" />\n        </div>\n    )\n}\n","import { useState, useEffect } from 'react'\nimport {\n    SPOTIFY_USER_TOKEN,\n    SPOTIFY_PLAYER_BASE_URL,\n    SPOTIFY_PLAYER_PLAY_URL,\n    SPOTIFY_PLAYER_PAUSE_URL,\n    SPOTIFY_PLAYER_NEXT_TRACK_URL,\n    SPOTIFY_PLAYER_PREVIOUS_TRACK_URL,\n    SPOTIFY_PLAYER_SEEK_URL,\n    SpotifyToken,\n    useAPI,\n    tokenHasExpired,\n    APIType,\n    SPOTIFY_PLAYER_RECOMMENDATION_URL,\n    TrackType,\n    LAST_PLAYED_TRACK,\n    SPOTIFY_PLAYER_GET_DEVICES_URL,\n    SPOTIFY_PLAYER_SET_DEVICE_URL,\n} from '.'\n\nconst POLLING_TIMEOUT = 5000\n\nexport class SpotifyPlayer {\n    playerInterval: null | number\n    token: SpotifyToken\n    api: APIType\n    pollingCallback: null | ((state: SpotifyApi.CurrentPlaybackResponse) => void)\n    abortController: AbortController\n\n    constructor(api: APIType) {\n        const token: SpotifyToken = JSON.parse(localStorage.getItem(SPOTIFY_USER_TOKEN))\n        this.token = token\n        this.playerInterval = null\n        this.pollingCallback = null\n        this.api = api\n        this.abortController = new AbortController()\n    }\n\n    pollPlayerState = (next: (state: SpotifyApi.CurrentPlaybackResponse) => void) => {\n        this.pollingCallback = next\n        this.getPlayerState(next)\n        this.playerInterval = window.setInterval(() => this.getPlayerState(next), POLLING_TIMEOUT)\n    }\n\n    clearPolling = () => {\n        if (this.playerInterval) clearInterval(this.playerInterval)\n    }\n\n    getPlayerState = (next: (state: SpotifyApi.CurrentPlaybackResponse) => void) => {\n        this.request(SPOTIFY_PLAYER_BASE_URL, {}).then(next)\n    }\n\n    getDevices = (): Promise<SpotifyApi.UserDevice[]> => {\n        const config = {\n            method: 'GET',\n        }\n        return this.request(SPOTIFY_PLAYER_GET_DEVICES_URL, config).then(\n            (res: SpotifyApi.UserDevicesResponse) => res.devices,\n        )\n    }\n\n    setDevice = (id: string): Promise<any> => {\n        const config = {\n            method: 'PUT',\n            body: JSON.stringify({\n                device_ids: [id],\n            }),\n        }\n        return this.request(SPOTIFY_PLAYER_SET_DEVICE_URL, config)\n    }\n\n    playTrack = (id: string, queue_id?: string) => {\n        const config = {\n            method: 'PUT',\n            body: JSON.stringify({\n                uris: [`spotify:track:${id}`],\n            }),\n        }\n\n        this.abortController.abort()\n        this.abortController = new AbortController()\n\n        this.request(SPOTIFY_PLAYER_PLAY_URL, config).then(() => {\n            setTimeout(() => this.getPlayerState(this.pollingCallback), 500)\n        })\n        if (queue_id) this.api.doRemoveTrackFromQueue(queue_id)\n    }\n\n    playSimilarTrack = () => {\n        const id = localStorage.getItem(LAST_PLAYED_TRACK)\n        const config = {\n            method: 'GET',\n        }\n        const url = `${SPOTIFY_PLAYER_RECOMMENDATION_URL}?seed_tracks=${id}&limit=1`\n        this.request(url, config).then(({ tracks }: { tracks: TrackType[] }) => {\n            if (tracks && tracks.length > 0) {\n                this.playTrack(tracks[0].id)\n                // this.pollingCalback(tracks[0].id)\n            }\n        })\n    }\n\n    changeTrack = (next: boolean = true) => {\n        const url = next ? SPOTIFY_PLAYER_NEXT_TRACK_URL : SPOTIFY_PLAYER_PREVIOUS_TRACK_URL\n        const config = {\n            method: 'POST',\n        }\n        this.request(url, config)\n    }\n\n    togglePlayback = (isPlaying: boolean) => {\n        const url = isPlaying ? SPOTIFY_PLAYER_PAUSE_URL : SPOTIFY_PLAYER_PLAY_URL\n        const config = {\n            method: 'PUT',\n        }\n        this.request(url, config)\n    }\n\n    seekInPlayingTrack = (ms: number) => {\n        const url = `${SPOTIFY_PLAYER_SEEK_URL}?position_ms=${ms}`\n        const config = { method: 'PUT' }\n        this.request(url, config)\n    }\n\n    refreshToken = (): Promise<void> => {\n        console.log('Token expired:', this.token)\n        return this.api.doRefreshUserToken(this.token).then(token => {\n            this.token = token\n        })\n    }\n\n    request = (url: string, config: object) => {\n        if (this.token && tokenHasExpired(this.token)) {\n            return this.refreshToken().then(() => this.request(url, config))\n        }\n        return fetch(url, {\n            headers: {\n                Authorization: `Bearer ${this.token.access_token}`,\n            },\n            ...config,\n            signal: this.abortController.signal,\n        })\n            .then(res => {\n                if (res.status === 400) console.error(res.json())\n                if (res.status !== 204) return res.json()\n                else return res\n            })\n            .catch(err => console.error('Spotify API responded with error:', err))\n    }\n}\n\nexport const useSpotify = (): {\n    playerState: SpotifyApi.CurrentPlaybackResponse\n    controller: SpotifyPlayer\n    fetching: boolean\n} => {\n    const [initialFetch, setInitialFetch] = useState(true)\n    const api = useAPI()\n    const [spotify, setSpotify] = useState(new SpotifyPlayer(api))\n    const [playerState, setPlayerState] = useState<SpotifyApi.CurrentPlaybackResponse>(\n        {} as SpotifyApi.CurrentPlaybackResponse,\n    )\n    useEffect(() => {\n        spotify.pollPlayerState((state: SpotifyApi.CurrentPlaybackResponse) => {\n            if (initialFetch) setInitialFetch(false)\n            setPlayerState(state)\n            if (state.item) localStorage.setItem(LAST_PLAYED_TRACK, state.item.id)\n        })\n        return spotify.clearPolling\n    }, [])\n    return { playerState, controller: spotify, fetching: initialFetch }\n}\n","import React from 'react'\nimport { Header } from '../Common/'\nimport { TrackList } from './'\nimport { Search } from '../Search'\nimport { RouteComponentProps } from 'react-router'\nimport { useWebSocket } from '../../utils'\nimport './styles/Spectator.scss'\n\ninterface MatchParams {\n    id: string\n}\n\ninterface Props extends RouteComponentProps<MatchParams> {}\n\nexport const Spectator: React.FC<Props> = React.memo(({ match }) => {\n    const { subscribers, queue } = useWebSocket(match.params.id)\n\n    return (\n        <div className=\"spectator\">\n            <Header color=\"green\" size=\"s\" numSubscribers={subscribers} />\n            <Search queue={queue}>\n                <TrackList onVote={queue.vote} votes={queue.votes} tracks={queue.tracks} />\n            </Search>\n        </div>\n    )\n})\n","import React from 'react'\nimport { TrackType } from '../../utils'\nimport { Heart, HeartOutline } from '../Common'\nimport './styles/TrackList.scss'\n\ninterface TrackListProps {\n    tracks: TrackType[]\n    votes: string[]\n    onVote: (id: string, voted: boolean) => void\n}\n\nexport const TrackList: React.FC<TrackListProps> = ({ tracks, votes, onVote }: TrackListProps) => {\n    return (\n        <div className=\"list-container\">\n            <ul className=\"track-list\">\n                {tracks.map((track, index) => {\n                    const hasVoted = votes.includes(track.queue_id)\n                    return (\n                        <li key={track.queue_id}>\n                            <img src={track.album_s} alt=\"\" />\n                            <div className=\"track-names\">\n                                <div>\n                                    <h3>{track.title}</h3>\n                                </div>\n                                <div>{track.artist}</div>\n                            </div>\n                            <div>\n                                <div>\n                                    {track.votes} vote{track.votes !== 1 && 's'}\n                                </div>\n                                <button onClick={() => onVote(track.queue_id, !hasVoted)}>\n                                    {hasVoted ? <Heart /> : <HeartOutline />}\n                                </button>\n                            </div>\n                        </li>\n                    )\n                })}\n            </ul>\n        </div>\n    )\n}\n","import React from 'react'\nimport { Header } from '../Common/'\nimport './styles/Login.scss'\n\ninterface Props {}\n\nexport const Login: React.FC<Props> = () => {\n    return (\n        <div className=\"login\">\n            <Header color=\"green\" size=\"s\" />\n            <h3>Login</h3>\n        </div>\n    )\n}\n","import React from 'react'\nimport { Start, Redirect, Spectator, Host, Login, URLNotFound } from './components/'\nimport * as ROUTES from './utils/routes'\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom'\nimport './styles/App.scss'\n\n/**\n * TODO:\n *  - Host/Spectator: Lazy-load additional search results\n *  - Host: Fullscreen mode\n *  - Host: Logout / Remove session\n *  - Host: Sync with lyrics from external API\n *  - Host: Pause/Play with keyboard input\n \n *\n * FIX:\n *  - Host: Close device list when clicking outside\n */\n\nconst App: React.FC = () => {\n    return (\n        <div className=\"App\">\n            <Router basename={process.env.PUBLIC_URL}>\n                <Switch>\n                    <Route path={ROUTES.START} exact component={Start} />\n                    <Route path={ROUTES.LOGIN} exact component={Login} />\n                    <Route path={ROUTES.ROOM} exact component={Spectator} />\n                    <Route path={ROUTES.HOST} exact component={Host} />\n                    <Route path={ROUTES.REDIRECT} exact component={Redirect} />\n                    <Route>\n                        <URLNotFound />\n                    </Route>\n                </Switch>\n            </Router>\n        </div>\n    )\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './styles/index.css'\nimport App from './App'\nimport { AuthContext, Auth, APIContext, API } from './utils/'\n\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(\n    <APIContext.Provider value={new API()}>\n        <AuthContext.Provider value={new Auth()}>\n            <App />\n        </AuthContext.Provider>\n    </APIContext.Provider>,\n    document.getElementById('root'),\n)\nserviceWorker.unregister()\n"],"sourceRoot":""}